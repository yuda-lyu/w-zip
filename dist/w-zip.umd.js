/*!
 * w-zip v1.0.17
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("path"),require("fs"),require("archiver"),require("archiver-zip-encrypted"),require("unzipper"),require("child_process")):"function"==typeof define&&define.amd?define(["path","fs","archiver","archiver-zip-encrypted","unzipper","child_process"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-zip"]=e(t.path,t.fs,t.archiver,t["archiver-zip-encrypted"],t.unzipper,t.child_process)}(this,(function(t,e,r,n,o,i){"use strict";var u="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function c(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var a=Array.isArray,f="object"==typeof u&&u&&u.Object===Object&&u,s=f,l="object"==typeof self&&self&&self.Object===Object&&self,v=s||l||Function("return this")(),p=v.Symbol,h=p,y=Object.prototype,d=y.hasOwnProperty,b=y.toString,_=h?h.toStringTag:void 0;var g=function(t){var e=d.call(t,_),r=t[_];try{t[_]=void 0;var n=!0}catch(t){}var o=b.call(t);return n&&(e?t[_]=r:delete t[_]),o},j=Object.prototype.toString;var m=g,w=function(t){return j.call(t)},S=p?p.toStringTag:void 0;var O=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":S&&S in Object(t)?m(t):w(t)};var x=function(t){return null!=t&&"object"==typeof t},z=O,P=x;var A=function(t){return"symbol"==typeof t||P(t)&&"[object Symbol]"==z(t)},k=a,F=A,E=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$=/^\w*$/;var T=function(t,e){if(k(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!F(t))||($.test(t)||!E.test(t)||null!=e&&t in Object(e))};var R=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},L=O,M=R;var C,N=function(t){if(!M(t))return!1;var e=L(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},D=v["__core-js_shared__"],I=(C=/[^.]+$/.exec(D&&D.keys&&D.keys.IE_PROTO||""))?"Symbol(src)_1."+C:"";var q=function(t){return!!I&&I in t},B=Function.prototype.toString;var U=function(t){if(null!=t){try{return B.call(t)}catch(t){}try{return t+""}catch(t){}}return""},W=N,V=q,Z=R,G=U,H=/^\[object .+?Constructor\]$/,J=Function.prototype,K=Object.prototype,Q=J.toString,X=K.hasOwnProperty,Y=RegExp("^"+Q.call(X).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var tt=function(t){return!(!Z(t)||V(t))&&(W(t)?Y:H).test(G(t))},et=function(t,e){return null==t?void 0:t[e]};var rt=function(t,e){var r=et(t,e);return tt(r)?r:void 0},nt=rt(Object,"create"),ot=nt;var it=function(){this.__data__=ot?ot(null):{},this.size=0};var ut=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},ct=nt,at=Object.prototype.hasOwnProperty;var ft=function(t){var e=this.__data__;if(ct){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return at.call(e,t)?e[t]:void 0},st=nt,lt=Object.prototype.hasOwnProperty;var vt=nt;var pt=it,ht=ut,yt=ft,dt=function(t){var e=this.__data__;return st?void 0!==e[t]:lt.call(e,t)},bt=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=vt&&void 0===e?"__lodash_hash_undefined__":e,this};function _t(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}_t.prototype.clear=pt,_t.prototype.delete=ht,_t.prototype.get=yt,_t.prototype.has=dt,_t.prototype.set=bt;var gt=_t;var jt=function(){this.__data__=[],this.size=0};var mt=function(t,e){return t===e||t!=t&&e!=e},wt=mt;var St=function(t,e){for(var r=t.length;r--;)if(wt(t[r][0],e))return r;return-1},Ot=St,xt=Array.prototype.splice;var zt=St;var Pt=St;var At=St;var kt=jt,Ft=function(t){var e=this.__data__,r=Ot(e,t);return!(r<0)&&(r==e.length-1?e.pop():xt.call(e,r,1),--this.size,!0)},Et=function(t){var e=this.__data__,r=zt(e,t);return r<0?void 0:e[r][1]},$t=function(t){return Pt(this.__data__,t)>-1},Tt=function(t,e){var r=this.__data__,n=At(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function Rt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Rt.prototype.clear=kt,Rt.prototype.delete=Ft,Rt.prototype.get=Et,Rt.prototype.has=$t,Rt.prototype.set=Tt;var Lt=Rt,Mt=rt(v,"Map"),Ct=gt,Nt=Lt,Dt=Mt;var It=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var qt=function(t,e){var r=t.__data__;return It(e)?r["string"==typeof e?"string":"hash"]:r.map},Bt=qt;var Ut=qt;var Wt=qt;var Vt=qt;var Zt=function(t,e){var r=Vt(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this},Gt=function(){this.size=0,this.__data__={hash:new Ct,map:new(Dt||Nt),string:new Ct}},Ht=function(t){var e=Bt(this,t).delete(t);return this.size-=e?1:0,e},Jt=function(t){return Ut(this,t).get(t)},Kt=function(t){return Wt(this,t).has(t)},Qt=Zt;function Xt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Xt.prototype.clear=Gt,Xt.prototype.delete=Ht,Xt.prototype.get=Jt,Xt.prototype.has=Kt,Xt.prototype.set=Qt;var Yt=Xt,te=Yt;function ee(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var u=t.apply(this,n);return r.cache=i.set(o,u)||i,u};return r.cache=new(ee.Cache||te),r}ee.Cache=te;var re=ee;var ne=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,oe=/\\(\\)?/g,ie=function(t){var e=re(t,(function(t){return 500===r.size&&r.clear(),t})),r=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(ne,(function(t,r,n,o){e.push(n?o.replace(oe,"$1"):r||t)})),e}));var ue=function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o},ce=ue,ae=a,fe=A,se=p?p.prototype:void 0,le=se?se.toString:void 0;var ve=function t(e){if("string"==typeof e)return e;if(ae(e))return ce(e,t)+"";if(fe(e))return le?le.call(e):"";var r=e+"";return"0"==r&&1/e==-Infinity?"-0":r},pe=ve;var he=function(t){return null==t?"":pe(t)},ye=a,de=T,be=ie,_e=he;var ge=function(t,e){return ye(t)?t:de(t,e)?[t]:be(_e(t))},je=A;var me=function(t){if("string"==typeof t||je(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e},we=ge,Se=me;var Oe=function(t,e){for(var r=0,n=(e=we(e,t)).length;null!=t&&r<n;)t=t[Se(e[r++])];return r&&r==n?t:void 0},xe=Oe;var ze=function(t,e,r){var n=null==t?void 0:xe(t,e);return void 0===n?r:n};function Pe(){let t,e,r=new Promise((function(){t=arguments[0],e=arguments[1]}));return r.resolve=t,r.reject=e,r}var Ae={},ke={get exports(){return Ae},set exports(t){Ae=t}};var Fe=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t};var Ee=function(t){return function(e,r,n){for(var o=-1,i=Object(e),u=n(e),c=u.length;c--;){var a=u[t?c:++o];if(!1===r(i[a],a,i))break}return e}}();var $e=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n},Te=O,Re=x;var Le=function(t){return Re(t)&&"[object Arguments]"==Te(t)},Me=x,Ce=Object.prototype,Ne=Ce.hasOwnProperty,De=Ce.propertyIsEnumerable,Ie=Le(function(){return arguments}())?Le:function(t){return Me(t)&&Ne.call(t,"callee")&&!De.call(t,"callee")},qe=Ie,Be={};var Ue=function(){return!1};!function(t,e){var r=v,n=Ue,o=e&&!e.nodeType&&e,i=o&&t&&!t.nodeType&&t,u=i&&i.exports===o?r.Buffer:void 0,c=(u?u.isBuffer:void 0)||n;t.exports=c}({get exports(){return Be},set exports(t){Be=t}},Be);var We=/^(?:0|[1-9]\d*)$/;var Ve=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&We.test(t))&&t>-1&&t%1==0&&t<e};var Ze=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},Ge=O,He=Ze,Je=x,Ke={};Ke["[object Float32Array]"]=Ke["[object Float64Array]"]=Ke["[object Int8Array]"]=Ke["[object Int16Array]"]=Ke["[object Int32Array]"]=Ke["[object Uint8Array]"]=Ke["[object Uint8ClampedArray]"]=Ke["[object Uint16Array]"]=Ke["[object Uint32Array]"]=!0,Ke["[object Arguments]"]=Ke["[object Array]"]=Ke["[object ArrayBuffer]"]=Ke["[object Boolean]"]=Ke["[object DataView]"]=Ke["[object Date]"]=Ke["[object Error]"]=Ke["[object Function]"]=Ke["[object Map]"]=Ke["[object Number]"]=Ke["[object Object]"]=Ke["[object RegExp]"]=Ke["[object Set]"]=Ke["[object String]"]=Ke["[object WeakMap]"]=!1;var Qe=function(t){return Je(t)&&He(t.length)&&!!Ke[Ge(t)]};var Xe=function(t){return function(e){return t(e)}},Ye={};!function(t,e){var r=f,n=e&&!e.nodeType&&e,o=n&&t&&!t.nodeType&&t,i=o&&o.exports===n&&r.process,u=function(){try{var t=o&&o.require&&o.require("util").types;return t||i&&i.binding&&i.binding("util")}catch(t){}}();t.exports=u}({get exports(){return Ye},set exports(t){Ye=t}},Ye);var tr=Qe,er=Xe,rr=Ye&&Ye.isTypedArray,nr=rr?er(rr):tr,or=$e,ir=qe,ur=a,cr=Be,ar=Ve,fr=nr,sr=Object.prototype.hasOwnProperty;var lr=function(t,e){var r=ur(t),n=!r&&ir(t),o=!r&&!n&&cr(t),i=!r&&!n&&!o&&fr(t),u=r||n||o||i,c=u?or(t.length,String):[],a=c.length;for(var f in t)!e&&!sr.call(t,f)||u&&("length"==f||o&&("offset"==f||"parent"==f)||i&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||ar(f,a))||c.push(f);return c},vr=Object.prototype;var pr=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||vr)};var hr=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),yr=pr,dr=hr,br=Object.prototype.hasOwnProperty;var _r=function(t){if(!yr(t))return dr(t);var e=[];for(var r in Object(t))br.call(t,r)&&"constructor"!=r&&e.push(r);return e},gr=N,jr=Ze;var mr=function(t){return null!=t&&jr(t.length)&&!gr(t)},wr=lr,Sr=_r,Or=mr;var xr=function(t){return Or(t)?wr(t):Sr(t)},zr=Ee,Pr=xr;var Ar=mr;var kr=function(t,e){return function(r,n){if(null==r)return r;if(!Ar(r))return t(r,n);for(var o=r.length,i=e?o:-1,u=Object(r);(e?i--:++i<o)&&!1!==n(u[i],i,u););return r}}((function(t,e){return t&&zr(t,e,Pr)}));var Fr=function(t){return t},Er=Fr;var $r=Fe,Tr=kr,Rr=function(t){return"function"==typeof t?t:Er},Lr=a;var Mr=function(t,e){return(Lr(t)?$r:Tr)(t,Rr(e))};!function(t){t.exports=Mr}(ke);var Cr=c(Ae),Nr=rt(v,"DataView"),Dr=Mt,Ir=rt(v,"Promise"),qr=rt(v,"Set"),Br=rt(v,"WeakMap"),Ur=O,Wr=U,Vr="[object Map]",Zr="[object Promise]",Gr="[object Set]",Hr="[object WeakMap]",Jr="[object DataView]",Kr=Wr(Nr),Qr=Wr(Dr),Xr=Wr(Ir),Yr=Wr(qr),tn=Wr(Br),en=Ur;(Nr&&en(new Nr(new ArrayBuffer(1)))!=Jr||Dr&&en(new Dr)!=Vr||Ir&&en(Ir.resolve())!=Zr||qr&&en(new qr)!=Gr||Br&&en(new Br)!=Hr)&&(en=function(t){var e=Ur(t),r="[object Object]"==e?t.constructor:void 0,n=r?Wr(r):"";if(n)switch(n){case Kr:return Jr;case Qr:return Vr;case Xr:return Zr;case Yr:return Gr;case tn:return Hr}return e});var rn=en,nn=O,on=a,un=x;var cn=function(t){return"string"==typeof t||!on(t)&&un(t)&&"[object String]"==nn(t)};var an=function(t){return function(e){return null==e?void 0:e[t]}},fn=an("length"),sn=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var ln=function(t){return sn.test(t)},vn="\\ud800-\\udfff",pn="["+vn+"]",hn="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",yn="\\ud83c[\\udffb-\\udfff]",dn="[^"+vn+"]",bn="(?:\\ud83c[\\udde6-\\uddff]){2}",_n="[\\ud800-\\udbff][\\udc00-\\udfff]",gn="(?:"+hn+"|"+yn+")"+"?",jn="[\\ufe0e\\ufe0f]?",mn=jn+gn+("(?:\\u200d(?:"+[dn,bn,_n].join("|")+")"+jn+gn+")*"),wn="(?:"+[dn+hn+"?",hn,bn,_n,pn].join("|")+")",Sn=RegExp(yn+"(?="+yn+")|"+wn+mn,"g");var On=fn,xn=ln,zn=function(t){for(var e=Sn.lastIndex=0;Sn.test(t);)++e;return e};var Pn=_r,An=rn,kn=mr,Fn=cn,En=function(t){return xn(t)?zn(t):On(t)};var $n=function(t){if(null==t)return 0;if(kn(t))return Fn(t)?En(t):t.length;var e=An(t);return"[object Map]"==e||"[object Set]"==e?t.size:Pn(t).length},Tn=ue;var Rn=function(t,e){return Tn(e,(function(e){return t[e]}))},Ln=xr;var Mn=function(t){return null==t?[]:Rn(t,Ln(t))};function Cn(t){return"[object Array]"===Object.prototype.toString.call(t)}function Nn(t){return"[object Object]"===Object.prototype.toString.call(t)}var Dn={};!function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}function o(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function i(t,e,n,i,u){if("function"!=typeof n)throw new TypeError("The listener must be a function");var c=new o(n,i||t,u),a=r?r+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],c]:t._events[a].push(c):(t._events[a]=c,t._eventsCount++),t}function u(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function c(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),c.prototype.eventNames=function(){var t,n,o=[];if(0===this._eventsCount)return o;for(n in t=this._events)e.call(t,n)&&o.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},c.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,u=new Array(i);o<i;o++)u[o]=n[o].fn;return u},c.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},c.prototype.emit=function(t,e,n,o,i,u){var c=r?r+t:t;if(!this._events[c])return!1;var a,f,s=this._events[c],l=arguments.length;if(s.fn){switch(s.once&&this.removeListener(t,s.fn,void 0,!0),l){case 1:return s.fn.call(s.context),!0;case 2:return s.fn.call(s.context,e),!0;case 3:return s.fn.call(s.context,e,n),!0;case 4:return s.fn.call(s.context,e,n,o),!0;case 5:return s.fn.call(s.context,e,n,o,i),!0;case 6:return s.fn.call(s.context,e,n,o,i,u),!0}for(f=1,a=new Array(l-1);f<l;f++)a[f-1]=arguments[f];s.fn.apply(s.context,a)}else{var v,p=s.length;for(f=0;f<p;f++)switch(s[f].once&&this.removeListener(t,s[f].fn,void 0,!0),l){case 1:s[f].fn.call(s[f].context);break;case 2:s[f].fn.call(s[f].context,e);break;case 3:s[f].fn.call(s[f].context,e,n);break;case 4:s[f].fn.call(s[f].context,e,n,o);break;default:if(!a)for(v=1,a=new Array(l-1);v<l;v++)a[v-1]=arguments[v];s[f].fn.apply(s[f].context,a)}}return!0},c.prototype.on=function(t,e,r){return i(this,t,e,r,!1)},c.prototype.once=function(t,e,r){return i(this,t,e,r,!0)},c.prototype.removeListener=function(t,e,n,o){var i=r?r+t:t;if(!this._events[i])return this;if(!e)return u(this,i),this;var c=this._events[i];if(c.fn)c.fn!==e||o&&!c.once||n&&c.context!==n||u(this,i);else{for(var a=0,f=[],s=c.length;a<s;a++)(c[a].fn!==e||o&&!c[a].once||n&&c[a].context!==n)&&f.push(c[a]);f.length?this._events[i]=1===f.length?f[0]:f:u(this,i)}return this},c.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&u(this,e)):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,t.exports=c}({get exports(){return Dn},set exports(t){Dn=t}});var In=Dn;var qn=/\s/;var Bn=function(t){for(var e=t.length;e--&&qn.test(t.charAt(e)););return e},Un=/^\s+/;var Wn=function(t){return t?t.slice(0,Bn(t)+1).replace(Un,""):t},Vn=R,Zn=A,Gn=/^[-+]0x[0-9a-f]+$/i,Hn=/^0b[01]+$/i,Jn=/^0o[0-7]+$/i,Kn=parseInt;var Qn=function(t){if("number"==typeof t)return t;if(Zn(t))return NaN;if(Vn(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Vn(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Wn(t);var r=Hn.test(t);return r||Jn.test(t)?Kn(t.slice(2),r?2:8):Gn.test(t)?NaN:+t},Xn=Qn,Yn=1/0;var to=function(t){return t?(t=Xn(t))===Yn||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0},eo=to;var ro=function(t){var e=eo(t),r=e%1;return e==e?r?e-r:e:0},no=ro;var oo=function(t){return"number"==typeof t&&t==no(t)};function io(t){return!(!function(t){return"[object String]"===Object.prototype.toString.call(t)}(t)||""===t)}function uo(t){let e=!1;return io(t)?e=!isNaN(Number(t)):function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)&&(e=!0),e}function co(t){if(!uo(t))return 0;return to(t)}function ao(t){return!!uo(t)&&(t=co(t),oo(t))}var fo=ro,so=Qn,lo=he,vo=v.isFinite,po=Math.min;var ho=function(t){var e=Math[t];return function(t,r){if(t=so(t),(r=null==r?0:po(fo(r),292))&&vo(t)){var n=(lo(t)+"e").split("e"),o=e(n[0]+"e"+(+n[1]+r));return+((n=(lo(o)+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}("round");function yo(t){if(!uo(t))return 0;t=co(t);let e=ho(t);return"0"===String(e)?0:e}function bo(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=0,r=[];var n;ao(n=t)&&yo(n)<0&&(t=0),t=yo(t);let o=new In;return o.get=function(){if(r.length>0){return e+=1,r.splice(0,1)[0]}return null},o.cb=function(){e-=1,e<0&&(e=0),r.length>0&&o.emit("message",r)},o.push=function(n){r.push(n),(t<=0||e<t)&&o.emit("message",r)},o.clear=function(){e=0,r=[]},o}function _o(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n={},o=!1,i=Pe();if(!Cn(t)&&!Nn(t))return i.reject("rs is not an array or object"),i;let u=!1;if(Nn(t)){u=!0;let e=[];Cr(t,((t,r)=>{e.push({k:r,v:t})})),t=e}let c=bo(r);return c.on("message",(function(r){if(o)return;let a,f=c.get();if(function(t){let e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}(e)){let t=f.key,r=f.value;u&&(t=f.value.k,r=f.value.v),a=e(r,t)}else a=f.value;a.then((t=>{n[f.key]=t})).catch((t=>{o=!0,c.clear(),i.reject(t)})).finally((()=>{c.cb(),$n(n)===t.length&&i.resolve(Mn(n))}))})),Cr(t,((t,e)=>{c.push({key:e,value:t})})),i}function go(t){if(!ao(t))return!1;return yo(t)>=0}function jo(t,e){if(!io(t))return"";if(!go(e))return"";if(0===(e=yo(e)))return"";let r=t.length-e;return r<0&&(r=0),t.substr(r,e)}function mo(t,e){return io(t)&&go(e)?0===(e=yo(e))?t:function(t,e){return io(t)&&go(e)?0===(e=yo(e))?"":t.substring(0,e):""}(t,t.length-e):""}function wo(t){if(!io(t))return"";let e=function(t){if(!io(t))return{path:"",isRoot:!1};for(;t.indexOf("\\\\")>=0;)t=t.replace("\\\\","\\");for(;t.indexOf("//")>=0;)t=t.replace("//","/");if(":"===jo(t,1))return{path:`${t}\\`,isRoot:!0};if("\\"===jo(t,1)){let e=mo(t,1);return":"===jo(e,1)?{path:t,isRoot:!0}:{path:e,isRoot:!1}}if("/"===jo(t,1)){let e=mo(t,1);return 0===$n(e)?{path:t,isRoot:!0}:{path:e,isRoot:!1}}return{path:t,isRoot:!1}}(t);if(e.isRoot)return e.path;let r=e.path;try{r=r.split("\\").pop().split("/").pop()}catch(t){}return r}function So(t){return!!e.existsSync(t)&&(!e.lstatSync(t).isFile()&&!e.lstatSync(t).isSymbolicLink())}function Oo(t){if(!e.existsSync(t))return{success:"folder does not exist: "+t};if(!So(t))return{error:"input path is not folder: "+t};try{e.readdirSync(t).forEach((function(r){let n=t+"/"+r;if(e.lstatSync(n).isDirectory())Oo(n);else try{e.unlinkSync(n)}catch(t){}}))}catch(t){return{error:t}}try{e.rmdirSync(t)}catch(t){return{error:t}}return{success:"done: "+t}}async function xo(t){try{r=t,!e.existsSync(r)||e.lstatSync(r).isDirectory()||e.lstatSync(r).isSymbolicLink()?So(t)&&Oo(t):e.unlinkSync(t),e.writeFileSync(t,"test","utf8"),e.unlinkSync(t)}catch(t){return!1}var r;return!0}r.registerFormat("zip-encrypted",n);var zo={zipFile:async function(n,o){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(n))return Promise.reject("invalid path of source file");if(!e.lstatSync(n).isFile())return Promise.reject("path of source is not file");if(!xo(o))return Promise.reject("invalid fpSrc");let u=ze(i,"level",9),c=ze(i,"pw","");try{let i=Pe();e.existsSync(t.dirname(o))||e.mkdirSync(t.dirname(o),{recursive:!0});let a,f=e.createWriteStream(o);return a=""===c?r("zip",{zlib:{level:u}}):r("zip-encrypted",{zlib:{level:u},encryptionMethod:"zip20",password:c}),f.on("close",(function(){i.resolve("done: "+o)})),a.on("warning",(function(t){})),a.on("error",(function(t){Promise.reject(t)})),a.pipe(f),a.file(n,{name:t.basename(n)}),a.finalize(),i}catch(t){return Promise.reject(t)}},zipFolder:async function(n,o){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(n))return Promise.reject("invalid path of source file");if(!e.lstatSync(n).isDirectory())return Promise.reject("path of source is not folder");if(!xo(o))return Promise.reject("invalid fpSrc");let u=ze(i,"level",9),c=ze(i,"pw","");try{let i=Pe();e.existsSync(t.dirname(o))||e.mkdirSync(t.dirname(o),{recursive:!0});let a,f=e.createWriteStream(o);return a=""===c?r("zip",{zlib:{level:u}}):r("zip-encrypted",{zlib:{level:u},encryptionMethod:"zip20",password:c}),f.on("close",(function(){i.resolve("done: "+o)})),a.on("warning",(function(t){})),a.on("error",(function(t){Promise.reject(t)})),a.pipe(f),a.directory(n,t.basename(n)),a.finalize(),i}catch(t){return Promise.reject(t)}},unzip:async function(r,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(r))return Promise.reject("invalid path of source file");if(!e.lstatSync(r).isFile())return Promise.reject("path of source is not file");if(!xo(n))return Promise.reject("invalid fpSrc");let u=ze(i,"pw","");try{return await async function(r,n,i){return _o((await o.Open.file(r)).files,(async r=>{let o=t.join(n,r.path);return"File"===r.type?async function(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{e.existsSync(t.dirname(n))||e.mkdirSync(t.dirname(n),{recursive:!0});let i=await r.buffer(o);e.writeFileSync(n,i)}catch(t){return Promise.reject(t)}return"done"}(r,o,i):async function(t){try{e.existsSync(t)||e.mkdirSync(t,{recursive:!0})}catch(t){return Promise.reject(t)}return"done"}(o)}))}(r,n,u),Promise.resolve("done: "+wo(n))}catch(t){return Promise.reject(t)}}};var Po=function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var u=t[r];e(u,r,t)&&(i[o++]=u)}return i},Ao=kr;var ko=function(t,e){var r=[];return Ao(t,(function(t,n,o){e(t,n,o)&&r.push(t)})),r},Fo=Lt;var Eo=Lt,$o=Mt,To=Yt;var Ro=Lt,Lo=function(){this.__data__=new Fo,this.size=0},Mo=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},Co=function(t){return this.__data__.get(t)},No=function(t){return this.__data__.has(t)},Do=function(t,e){var r=this.__data__;if(r instanceof Eo){var n=r.__data__;if(!$o||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new To(n)}return r.set(t,e),this.size=r.size,this};function Io(t){var e=this.__data__=new Ro(t);this.size=e.size}Io.prototype.clear=Lo,Io.prototype.delete=Mo,Io.prototype.get=Co,Io.prototype.has=No,Io.prototype.set=Do;var qo=Io;var Bo=Yt,Uo=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Wo=function(t){return this.__data__.has(t)};function Vo(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new Bo;++e<r;)this.add(t[e])}Vo.prototype.add=Vo.prototype.push=Uo,Vo.prototype.has=Wo;var Zo=Vo,Go=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1},Ho=function(t,e){return t.has(e)};var Jo=function(t,e,r,n,o,i){var u=1&r,c=t.length,a=e.length;if(c!=a&&!(u&&a>c))return!1;var f=i.get(t),s=i.get(e);if(f&&s)return f==e&&s==t;var l=-1,v=!0,p=2&r?new Zo:void 0;for(i.set(t,e),i.set(e,t);++l<c;){var h=t[l],y=e[l];if(n)var d=u?n(y,h,l,e,t,i):n(h,y,l,t,e,i);if(void 0!==d){if(d)continue;v=!1;break}if(p){if(!Go(e,(function(t,e){if(!Ho(p,e)&&(h===t||o(h,t,r,n,i)))return p.push(e)}))){v=!1;break}}else if(h!==y&&!o(h,y,r,n,i)){v=!1;break}}return i.delete(t),i.delete(e),v};var Ko=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r};var Qo=v.Uint8Array,Xo=mt,Yo=Jo,ti=Ko,ei=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r},ri=p?p.prototype:void 0,ni=ri?ri.valueOf:void 0;var oi=function(t,e,r,n,o,i,u){switch(r){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!i(new Qo(t),new Qo(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Xo(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var c=ti;case"[object Set]":var a=1&n;if(c||(c=ei),t.size!=e.size&&!a)return!1;var f=u.get(t);if(f)return f==e;n|=2,u.set(t,e);var s=Yo(c(t),c(e),n,o,i,u);return u.delete(t),s;case"[object Symbol]":if(ni)return ni.call(t)==ni.call(e)}return!1};var ii=function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t},ui=ii,ci=a;var ai=function(t,e,r){var n=e(t);return ci(t)?n:ui(n,r(t))};var fi=Po,si=function(){return[]},li=Object.prototype.propertyIsEnumerable,vi=Object.getOwnPropertySymbols,pi=ai,hi=vi?function(t){return null==t?[]:(t=Object(t),fi(vi(t),(function(e){return li.call(t,e)})))}:si,yi=xr;var di=function(t){return pi(t,yi,hi)},bi=Object.prototype.hasOwnProperty;var _i=qo,gi=Jo,ji=oi,mi=function(t,e,r,n,o,i){var u=1&r,c=di(t),a=c.length;if(a!=di(e).length&&!u)return!1;for(var f=a;f--;){var s=c[f];if(!(u?s in e:bi.call(e,s)))return!1}var l=i.get(t),v=i.get(e);if(l&&v)return l==e&&v==t;var p=!0;i.set(t,e),i.set(e,t);for(var h=u;++f<a;){var y=t[s=c[f]],d=e[s];if(n)var b=u?n(d,y,s,e,t,i):n(y,d,s,t,e,i);if(!(void 0===b?y===d||o(y,d,r,n,i):b)){p=!1;break}h||(h="constructor"==s)}if(p&&!h){var _=t.constructor,g=e.constructor;_==g||!("constructor"in t)||!("constructor"in e)||"function"==typeof _&&_ instanceof _&&"function"==typeof g&&g instanceof g||(p=!1)}return i.delete(t),i.delete(e),p},wi=rn,Si=a,Oi=Be,xi=nr,zi="[object Arguments]",Pi="[object Array]",Ai="[object Object]",ki=Object.prototype.hasOwnProperty;var Fi=function(t,e,r,n,o,i){var u=Si(t),c=Si(e),a=u?Pi:wi(t),f=c?Pi:wi(e),s=(a=a==zi?Ai:a)==Ai,l=(f=f==zi?Ai:f)==Ai,v=a==f;if(v&&Oi(t)){if(!Oi(e))return!1;u=!0,s=!1}if(v&&!s)return i||(i=new _i),u||xi(t)?gi(t,e,r,n,o,i):ji(t,e,a,r,n,o,i);if(!(1&r)){var p=s&&ki.call(t,"__wrapped__"),h=l&&ki.call(e,"__wrapped__");if(p||h){var y=p?t.value():t,d=h?e.value():e;return i||(i=new _i),o(y,d,r,n,i)}}return!!v&&(i||(i=new _i),mi(t,e,r,n,o,i))},Ei=x;var $i=function t(e,r,n,o,i){return e===r||(null==e||null==r||!Ei(e)&&!Ei(r)?e!=e&&r!=r:Fi(e,r,n,o,t,i))},Ti=qo,Ri=$i;var Li=R;var Mi=function(t){return t==t&&!Li(t)},Ci=Mi,Ni=xr;var Di=function(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}},Ii=function(t,e,r,n){var o=r.length,i=o,u=!n;if(null==t)return!i;for(t=Object(t);o--;){var c=r[o];if(u&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++o<i;){var a=(c=r[o])[0],f=t[a],s=c[1];if(u&&c[2]){if(void 0===f&&!(a in t))return!1}else{var l=new Ti;if(n)var v=n(f,s,a,t,e,l);if(!(void 0===v?Ri(s,f,3,n,l):v))return!1}}return!0},qi=function(t){for(var e=Ni(t),r=e.length;r--;){var n=e[r],o=t[n];e[r]=[n,o,Ci(o)]}return e},Bi=Di;var Ui=ge,Wi=qe,Vi=a,Zi=Ve,Gi=Ze,Hi=me;var Ji=function(t,e,r){for(var n=-1,o=(e=Ui(e,t)).length,i=!1;++n<o;){var u=Hi(e[n]);if(!(i=null!=t&&r(t,u)))break;t=t[u]}return i||++n!=o?i:!!(o=null==t?0:t.length)&&Gi(o)&&Zi(u,o)&&(Vi(t)||Wi(t))},Ki=function(t,e){return null!=t&&e in Object(t)},Qi=Ji;var Xi=function(t,e){return null!=t&&Qi(t,e,Ki)},Yi=$i,tu=ze,eu=Xi,ru=T,nu=Mi,ou=Di,iu=me;var uu=function(t,e){return ru(t)&&nu(e)?ou(iu(t),e):function(r){var n=tu(r,t);return void 0===n&&n===e?eu(r,t):Yi(e,n,3)}},cu=Oe;var au=function(t){return function(e){return cu(e,t)}},fu=an,su=au,lu=T,vu=me;var pu=function(t){return lu(t)?fu(vu(t)):su(t)},hu=function(t){var e=qi(t);return 1==e.length&&e[0][2]?Bi(e[0][0],e[0][1]):function(r){return r===t||Ii(r,t,e)}},yu=uu,du=Fr,bu=a,_u=pu;var gu=function(t){return"function"==typeof t?t:null==t?du:"object"==typeof t?bu(t)?yu(t[0],t[1]):hu(t):_u(t)},ju=Po,mu=ko,wu=gu,Su=a;var Ou=function(t,e){return(Su(t)?ju:mu)(t,wu(e))},xu=kr,zu=mr;var Pu=ue,Au=gu,ku=function(t,e){var r=-1,n=zu(t)?Array(t.length):[];return xu(t,(function(t,o,i){n[++r]=e(t,o,i)})),n},Fu=a;var Eu=function(t,e){return(Fu(t)?Pu:ku)(t,Au(e))},$u=Array.prototype.join;var Tu=function(t,e){return null==t?"":$u.call(t,e)};function Ru(t,e){return new Promise((function(r,n){Cn(e)||(e=[e]);let o=i.spawnSync(t,e),u=Ou(o.output,(t=>null!==t));u=Eu(u,(t=>function(t){try{return t.toString("utf8")}catch(t){}return""}(t)));let c=Tu(u,""),a=ze(o,"error.message");a?n(a):r(c)}))}var Lu=function(){let t="C:\\Program Files\\7-Zip\\7z.exe";async function r(e,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=["a",r,e,`-mx${arguments.length>2&&void 0!==arguments[2]?arguments[2]:9}`];return""!==n&&o.push(`-p${n}`),Ru(t,o)}return{setProg:function(r){return e.existsSync(r)?e.lstatSync(r).isFile()?{error:"path of 7z is not file"}:(t=r,{success:"done: "+r}):{error:"invalid path of 7z"}},zipFile:async function(t,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(t))return Promise.reject("invalid path of source file");if(!e.lstatSync(t).isFile())return Promise.reject("path of source is not file");if(!xo(n))return Promise.reject("invalid fpSrc");let i=ze(o,"level",9),u=ze(o,"pw",""),c=null,a=await r(t,n,i,u).catch((t=>{c=t}));return c?Promise.reject(c):{state:"finish: "+n,msg7z:a}},zipFolder:async function(t,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(t))return Promise.reject("invalid path of source file");if(!e.lstatSync(t).isDirectory())return Promise.reject("path of source is not folder");if(!xo(n))return Promise.reject("invalid fpSrc");let i=ze(o,"level",9),u=ze(o,"pw",""),c=null,a=await r(t,n,i,u).catch((t=>{c=t}));return c?Promise.reject(c):{state:"finish: "+n,msg7z:a}},unzip:async function(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(r))return Promise.reject("invalid path of source file");if(!e.lstatSync(r).isFile())return Promise.reject("path of source is not file");if(!xo(n))return Promise.reject("invalid fpSrc");let i=ze(o,"pw",""),u=["x",r,"-o"+n];""!==i&&u.push(`-p${i}`);let c=null,a=await Ru(t,u).catch((t=>{c=t}));return c?Promise.reject(c):{state:"finish: "+wo(n),msg7z:a}}}}();return{mZip:zo,m7z:Lu}}));
//# sourceMappingURL=w-zip.umd.js.map
