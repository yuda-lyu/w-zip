/*!
 * w-zip v1.0.18
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("path"),require("fs"),require("archiver"),require("archiver-zip-encrypted"),require("unzipper"),require("child_process")):"function"==typeof define&&define.amd?define(["path","fs","archiver","archiver-zip-encrypted","unzipper","child_process"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-zip"]=e(t.path,t.fs,t.archiver,t["archiver-zip-encrypted"],t.unzipper,t.child_process)}(this,(function(t,e,r,n,o,i){"use strict";var u=Array.isArray,c="object"==typeof global&&global&&global.Object===Object&&global,a="object"==typeof self&&self&&self.Object===Object&&self,f=c||a||Function("return this")(),s=f.Symbol,l=Object.prototype,p=l.hasOwnProperty,v=l.toString,h=s?s.toStringTag:void 0;var y=Object.prototype.toString;var d="[object Null]",b="[object Undefined]",_=s?s.toStringTag:void 0;function j(t){return null==t?void 0===t?b:d:_&&_ in Object(t)?function(t){var e=p.call(t,h),r=t[h];try{t[h]=void 0;var n=!0}catch(t){}var o=v.call(t);return n&&(e?t[h]=r:delete t[h]),o}(t):function(t){return y.call(t)}(t)}function g(t){return null!=t&&"object"==typeof t}var m="[object Symbol]";function w(t){return"symbol"==typeof t||g(t)&&j(t)==m}var S=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,O=/^\w*$/;function x(t,e){if(u(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!w(t))||(O.test(t)||!S.test(t)||null!=e&&t in Object(e))}function z(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var P="[object AsyncFunction]",A="[object Function]",k="[object GeneratorFunction]",F="[object Proxy]";function E(t){if(!z(t))return!1;var e=j(t);return e==A||e==k||e==P||e==F}var $,R=f["__core-js_shared__"],L=($=/[^.]+$/.exec(R&&R.keys&&R.keys.IE_PROTO||""))?"Symbol(src)_1."+$:"";var T=Function.prototype.toString;function C(t){if(null!=t){try{return T.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var M=/^\[object .+?Constructor\]$/,D=Function.prototype,N=Object.prototype,q=D.toString,I=N.hasOwnProperty,B=RegExp("^"+q.call(I).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function U(t){return!(!z(t)||(e=t,L&&L in e))&&(E(t)?B:M).test(C(t));var e}function W(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return U(r)?r:void 0}var V=W(Object,"create");var Z=Object.prototype.hasOwnProperty;var G=Object.prototype.hasOwnProperty;function H(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function J(t,e){return t===e||t!=t&&e!=e}function K(t,e){for(var r=t.length;r--;)if(J(t[r][0],e))return r;return-1}H.prototype.clear=function(){this.__data__=V?V(null):{},this.size=0},H.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},H.prototype.get=function(t){var e=this.__data__;if(V){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return Z.call(e,t)?e[t]:void 0},H.prototype.has=function(t){var e=this.__data__;return V?void 0!==e[t]:G.call(e,t)},H.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=V&&void 0===e?"__lodash_hash_undefined__":e,this};var Q=Array.prototype.splice;function X(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}X.prototype.clear=function(){this.__data__=[],this.size=0},X.prototype.delete=function(t){var e=this.__data__,r=K(e,t);return!(r<0)&&(r==e.length-1?e.pop():Q.call(e,r,1),--this.size,!0)},X.prototype.get=function(t){var e=this.__data__,r=K(e,t);return r<0?void 0:e[r][1]},X.prototype.has=function(t){return K(this.__data__,t)>-1},X.prototype.set=function(t,e){var r=this.__data__,n=K(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var Y=W(f,"Map");function tt(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function et(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}et.prototype.clear=function(){this.size=0,this.__data__={hash:new H,map:new(Y||X),string:new H}},et.prototype.delete=function(t){var e=tt(this,t).delete(t);return this.size-=e?1:0,e},et.prototype.get=function(t){return tt(this,t).get(t)},et.prototype.has=function(t){return tt(this,t).has(t)},et.prototype.set=function(t,e){var r=tt(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};var rt="Expected a function";function nt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(rt);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var u=t.apply(this,n);return r.cache=i.set(o,u)||i,u};return r.cache=new(nt.Cache||et),r}nt.Cache=et;var ot,it,ut,ct=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,at=/\\(\\)?/g,ft=(ot=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(ct,(function(t,r,n,o){e.push(n?o.replace(at,"$1"):r||t)})),e},it=nt(ot,(function(t){return 500===ut.size&&ut.clear(),t})),ut=it.cache,it),st=ft;function lt(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}var pt=1/0,vt=s?s.prototype:void 0,ht=vt?vt.toString:void 0;function yt(t){if("string"==typeof t)return t;if(u(t))return lt(t,yt)+"";if(w(t))return ht?ht.call(t):"";var e=t+"";return"0"==e&&1/t==-pt?"-0":e}function dt(t){return null==t?"":yt(t)}function bt(t,e){return u(t)?t:x(t,e)?[t]:st(dt(t))}var _t=1/0;function jt(t){if("string"==typeof t||w(t))return t;var e=t+"";return"0"==e&&1/t==-_t?"-0":e}function gt(t,e){for(var r=0,n=(e=bt(e,t)).length;null!=t&&r<n;)t=t[jt(e[r++])];return r&&r==n?t:void 0}function mt(t,e,r){var n=null==t?void 0:gt(t,e);return void 0===n?r:n}function wt(){let t,e,r=new Promise((function(){t=arguments[0],e=arguments[1]}));return r.resolve=t,r.reject=e,r}function St(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t}var Ot,xt=function(t,e,r){for(var n=-1,o=Object(t),i=r(t),u=i.length;u--;){var c=i[Ot?u:++n];if(!1===e(o[c],c,o))break}return t};function zt(t){return g(t)&&"[object Arguments]"==j(t)}var Pt=Object.prototype,At=Pt.hasOwnProperty,kt=Pt.propertyIsEnumerable,Ft=zt(function(){return arguments}())?zt:function(t){return g(t)&&At.call(t,"callee")&&!kt.call(t,"callee")},Et=Ft;var $t="object"==typeof exports&&exports&&!exports.nodeType&&exports,Rt=$t&&"object"==typeof module&&module&&!module.nodeType&&module,Lt=Rt&&Rt.exports===$t?f.Buffer:void 0,Tt=(Lt?Lt.isBuffer:void 0)||function(){return!1},Ct=9007199254740991,Mt=/^(?:0|[1-9]\d*)$/;function Dt(t,e){var r=typeof t;return!!(e=null==e?Ct:e)&&("number"==r||"symbol"!=r&&Mt.test(t))&&t>-1&&t%1==0&&t<e}var Nt=9007199254740991;function qt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Nt}var It={};It["[object Float32Array]"]=It["[object Float64Array]"]=It["[object Int8Array]"]=It["[object Int16Array]"]=It["[object Int32Array]"]=It["[object Uint8Array]"]=It["[object Uint8ClampedArray]"]=It["[object Uint16Array]"]=It["[object Uint32Array]"]=!0,It["[object Arguments]"]=It["[object Array]"]=It["[object ArrayBuffer]"]=It["[object Boolean]"]=It["[object DataView]"]=It["[object Date]"]=It["[object Error]"]=It["[object Function]"]=It["[object Map]"]=It["[object Number]"]=It["[object Object]"]=It["[object RegExp]"]=It["[object Set]"]=It["[object String]"]=It["[object WeakMap]"]=!1;var Bt="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ut=Bt&&"object"==typeof module&&module&&!module.nodeType&&module,Wt=Ut&&Ut.exports===Bt&&c.process,Vt=function(){try{var t=Ut&&Ut.require&&Ut.require("util").types;return t||Wt&&Wt.binding&&Wt.binding("util")}catch(t){}}(),Zt=Vt&&Vt.isTypedArray,Gt=Zt?function(t){return function(e){return t(e)}}(Zt):function(t){return g(t)&&qt(t.length)&&!!It[j(t)]},Ht=Gt,Jt=Object.prototype.hasOwnProperty;function Kt(t,e){var r=u(t),n=!r&&Et(t),o=!r&&!n&&Tt(t),i=!r&&!n&&!o&&Ht(t),c=r||n||o||i,a=c?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],f=a.length;for(var s in t)!e&&!Jt.call(t,s)||c&&("length"==s||o&&("offset"==s||"parent"==s)||i&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||Dt(s,f))||a.push(s);return a}var Qt=Object.prototype;var Xt=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),Yt=Xt,te=Object.prototype.hasOwnProperty;function ee(t){if(r=(e=t)&&e.constructor,e!==("function"==typeof r&&r.prototype||Qt))return Yt(t);var e,r,n=[];for(var o in Object(t))te.call(t,o)&&"constructor"!=o&&n.push(o);return n}function re(t){return null!=t&&qt(t.length)&&!E(t)}function ne(t){return re(t)?Kt(t):ee(t)}var oe=function(t,e){return function(r,n){if(null==r)return r;if(!re(r))return t(r,n);for(var o=r.length,i=e?o:-1,u=Object(r);(e?i--:++i<o)&&!1!==n(u[i],i,u););return r}}((function(t,e){return t&&xt(t,e,ne)})),ie=oe;function ue(t){return t}function ce(t,e){var r;return(u(t)?St:ie)(t,"function"==typeof(r=e)?r:ue)}var ae=W(f,"DataView"),fe=W(f,"Promise"),se=W(f,"Set"),le=W(f,"WeakMap"),pe="[object Map]",ve="[object Promise]",he="[object Set]",ye="[object WeakMap]",de="[object DataView]",be=C(ae),_e=C(Y),je=C(fe),ge=C(se),me=C(le),we=j;(ae&&we(new ae(new ArrayBuffer(1)))!=de||Y&&we(new Y)!=pe||fe&&we(fe.resolve())!=ve||se&&we(new se)!=he||le&&we(new le)!=ye)&&(we=function(t){var e=j(t),r="[object Object]"==e?t.constructor:void 0,n=r?C(r):"";if(n)switch(n){case be:return de;case _e:return pe;case je:return ve;case ge:return he;case me:return ye}return e});var Se=we,Oe="[object String]";function xe(t){return function(e){return null==e?void 0:e[t]}}var ze=xe("length"),Pe=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Ae="\\ud800-\\udfff",ke="["+Ae+"]",Fe="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Ee="\\ud83c[\\udffb-\\udfff]",$e="[^"+Ae+"]",Re="(?:\\ud83c[\\udde6-\\uddff]){2}",Le="[\\ud800-\\udbff][\\udc00-\\udfff]",Te="(?:"+Fe+"|"+Ee+")"+"?",Ce="[\\ufe0e\\ufe0f]?",Me=Ce+Te+("(?:\\u200d(?:"+[$e,Re,Le].join("|")+")"+Ce+Te+")*"),De="(?:"+[$e+Fe+"?",Fe,Re,Le,ke].join("|")+")",Ne=RegExp(Ee+"(?="+Ee+")|"+De+Me,"g");function qe(t){return function(t){return Pe.test(t)}(t)?function(t){for(var e=Ne.lastIndex=0;Ne.test(t);)++e;return e}(t):ze(t)}var Ie="[object Map]",Be="[object Set]";function Ue(t){if(null==t)return 0;if(re(t))return"string"==typeof(e=t)||!u(e)&&g(e)&&j(e)==Oe?qe(t):t.length;var e,r=Se(t);return r==Ie||r==Be?t.size:ee(t).length}function We(t){return null==t?[]:function(t,e){return lt(e,(function(e){return t[e]}))}(t,ne(t))}function Ve(t){return"[object Array]"===Object.prototype.toString.call(t)}function Ze(t){return"[object Object]"===Object.prototype.toString.call(t)}var Ge={};!function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}function o(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function i(t,e,n,i,u){if("function"!=typeof n)throw new TypeError("The listener must be a function");var c=new o(n,i||t,u),a=r?r+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],c]:t._events[a].push(c):(t._events[a]=c,t._eventsCount++),t}function u(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function c(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),c.prototype.eventNames=function(){var t,n,o=[];if(0===this._eventsCount)return o;for(n in t=this._events)e.call(t,n)&&o.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},c.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,u=new Array(i);o<i;o++)u[o]=n[o].fn;return u},c.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},c.prototype.emit=function(t,e,n,o,i,u){var c=r?r+t:t;if(!this._events[c])return!1;var a,f,s=this._events[c],l=arguments.length;if(s.fn){switch(s.once&&this.removeListener(t,s.fn,void 0,!0),l){case 1:return s.fn.call(s.context),!0;case 2:return s.fn.call(s.context,e),!0;case 3:return s.fn.call(s.context,e,n),!0;case 4:return s.fn.call(s.context,e,n,o),!0;case 5:return s.fn.call(s.context,e,n,o,i),!0;case 6:return s.fn.call(s.context,e,n,o,i,u),!0}for(f=1,a=new Array(l-1);f<l;f++)a[f-1]=arguments[f];s.fn.apply(s.context,a)}else{var p,v=s.length;for(f=0;f<v;f++)switch(s[f].once&&this.removeListener(t,s[f].fn,void 0,!0),l){case 1:s[f].fn.call(s[f].context);break;case 2:s[f].fn.call(s[f].context,e);break;case 3:s[f].fn.call(s[f].context,e,n);break;case 4:s[f].fn.call(s[f].context,e,n,o);break;default:if(!a)for(p=1,a=new Array(l-1);p<l;p++)a[p-1]=arguments[p];s[f].fn.apply(s[f].context,a)}}return!0},c.prototype.on=function(t,e,r){return i(this,t,e,r,!1)},c.prototype.once=function(t,e,r){return i(this,t,e,r,!0)},c.prototype.removeListener=function(t,e,n,o){var i=r?r+t:t;if(!this._events[i])return this;if(!e)return u(this,i),this;var c=this._events[i];if(c.fn)c.fn!==e||o&&!c.once||n&&c.context!==n||u(this,i);else{for(var a=0,f=[],s=c.length;a<s;a++)(c[a].fn!==e||o&&!c[a].once||n&&c[a].context!==n)&&f.push(c[a]);f.length?this._events[i]=1===f.length?f[0]:f:u(this,i)}return this},c.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&u(this,e)):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,t.exports=c}({get exports(){return Ge},set exports(t){Ge=t}});var He=Ge;var Je=/\s/;var Ke=/^\s+/;function Qe(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&Je.test(t.charAt(e)););return e}(t)+1).replace(Ke,""):t}var Xe=NaN,Ye=/^[-+]0x[0-9a-f]+$/i,tr=/^0b[01]+$/i,er=/^0o[0-7]+$/i,rr=parseInt;function nr(t){if("number"==typeof t)return t;if(w(t))return Xe;if(z(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=z(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Qe(t);var r=tr.test(t);return r||er.test(t)?rr(t.slice(2),r?2:8):Ye.test(t)?Xe:+t}var or=1/0,ir=17976931348623157e292;function ur(t){return t?(t=nr(t))===or||t===-or?(t<0?-1:1)*ir:t==t?t:0:0===t?t:0}function cr(t){var e=ur(t),r=e%1;return e==e?r?e-r:e:0}function ar(t){return!(!function(t){return"[object String]"===Object.prototype.toString.call(t)}(t)||""===t)}function fr(t){let e=!1;if(ar(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(function(t){return t!=t}(t))return!1;e=!0}return e}function sr(t){if(!fr(t))return 0;return ur(t)}function lr(t){return!!fr(t)&&(t=sr(t),"number"==typeof(e=t)&&e==cr(e));var e}var pr=f.isFinite,vr=Math.min;var hr=function(t){var e=Math[t];return function(t,r){if(t=nr(t),(r=null==r?0:vr(cr(r),292))&&pr(t)){var n=(dt(t)+"e").split("e");return+((n=(dt(e(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}("round"),yr=hr;function dr(t){if(!fr(t))return 0;t=sr(t);let e=yr(t);return"0"===String(e)?0:e}function br(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=0,r=[];var n;lr(n=t)&&dr(n)<0&&(t=0),t=dr(t);let o=new He;return o.get=function(){if(r.length>0){return e+=1,r.splice(0,1)[0]}return null},o.cb=function(){e-=1,e<0&&(e=0),r.length>0&&o.emit("message",r)},o.push=function(n){r.push(n),(t<=0||e<t)&&o.emit("message",r)},o.clear=function(){e=0,r=[]},o}function _r(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n={},o=!1,i=wt();if(!Ve(t)&&!Ze(t))return i.reject("rs is not an array or object"),i;let u=!1;if(Ze(t)){u=!0;let e=[];ce(t,((t,r)=>{e.push({k:r,v:t})})),t=e}let c=br(r);return c.on("message",(function(r){if(o)return;let a,f=c.get();if(function(t){let e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}(e)){let t=f.key,r=f.value;u&&(t=f.value.k,r=f.value.v),a=e(r,t)}else a=f.value;a.then((t=>{n[f.key]=t})).catch((t=>{o=!0,c.clear(),i.reject(t)})).finally((()=>{c.cb(),Ue(n)===t.length&&i.resolve(We(n))}))})),ce(t,((t,e)=>{c.push({key:e,value:t})})),i}function jr(t){if(!lr(t))return!1;return dr(t)>=0}function gr(t,e){if(!ar(t))return"";if(!jr(e))return"";if(0===(e=dr(e)))return"";let r=t.length-e;return r<0&&(r=0),t.substr(r,e)}function mr(t,e){return ar(t)&&jr(e)?0===(e=dr(e))?t:function(t,e){return ar(t)&&jr(e)?0===(e=dr(e))?"":t.substring(0,e):""}(t,t.length-e):""}function wr(t){if(!ar(t))return"";let e=function(t){if(!ar(t))return{path:"",isRoot:!1};for(;t.indexOf("\\\\")>=0;)t=t.replace("\\\\","\\");for(;t.indexOf("//")>=0;)t=t.replace("//","/");if(":"===gr(t,1))return{path:`${t}\\`,isRoot:!0};if("\\"===gr(t,1)){let e=mr(t,1);return":"===gr(e,1)?{path:t,isRoot:!0}:{path:e,isRoot:!1}}if("/"===gr(t,1)){let e=mr(t,1);return 0===Ue(e)?{path:t,isRoot:!0}:{path:e,isRoot:!1}}return{path:t,isRoot:!1}}(t);if(e.isRoot)return e.path;let r=e.path;try{r=r.split("\\").pop().split("/").pop()}catch(t){}return r}function Sr(t){return!!e.existsSync(t)&&(!e.lstatSync(t).isFile()&&!e.lstatSync(t).isSymbolicLink())}function Or(t){if(!e.existsSync(t))return{success:"folder does not exist: "+t};if(!Sr(t))return{error:"input path is not a folder: "+t};try{e.readdirSync(t).forEach((function(r){let n=t+"/"+r;if(e.lstatSync(n).isDirectory())Or(n);else try{e.unlinkSync(n)}catch(t){}}))}catch(t){return{error:t}}try{e.rmdirSync(t)}catch(t){return{error:t}}return{success:"done: "+t}}async function xr(t){try{r=t,!e.existsSync(r)||e.lstatSync(r).isDirectory()||e.lstatSync(r).isSymbolicLink()?Sr(t)&&Or(t):e.unlinkSync(t),e.writeFileSync(t,"test","utf8"),e.unlinkSync(t)}catch(t){return!1}var r;return!0}r.registerFormat("zip-encrypted",n);var zr={zipFile:async function(n,o){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(n))return Promise.reject("invalid path of source file");if(!e.lstatSync(n).isFile())return Promise.reject("path of source is not file");if(!xr(o))return Promise.reject("invalid fpSrc");let u=mt(i,"level",9),c=mt(i,"pw","");try{let i=wt();e.existsSync(t.dirname(o))||e.mkdirSync(t.dirname(o),{recursive:!0});let a,f=e.createWriteStream(o);return a=""===c?r("zip",{zlib:{level:u}}):r("zip-encrypted",{zlib:{level:u},encryptionMethod:"zip20",password:c}),f.on("close",(function(){i.resolve("done: "+o)})),a.on("warning",(function(t){})),a.on("error",(function(t){Promise.reject(t)})),a.pipe(f),a.file(n,{name:t.basename(n)}),a.finalize(),i}catch(t){return Promise.reject(t)}},zipFolder:async function(n,o){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(n))return Promise.reject("invalid path of source file");if(!e.lstatSync(n).isDirectory())return Promise.reject("path of source is not folder");if(!xr(o))return Promise.reject("invalid fpSrc");let u=mt(i,"level",9),c=mt(i,"pw","");try{let i=wt();e.existsSync(t.dirname(o))||e.mkdirSync(t.dirname(o),{recursive:!0});let a,f=e.createWriteStream(o);return a=""===c?r("zip",{zlib:{level:u}}):r("zip-encrypted",{zlib:{level:u},encryptionMethod:"zip20",password:c}),f.on("close",(function(){i.resolve("done: "+o)})),a.on("warning",(function(t){})),a.on("error",(function(t){Promise.reject(t)})),a.pipe(f),a.directory(n,t.basename(n)),a.finalize(),i}catch(t){return Promise.reject(t)}},unzip:async function(r,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(r))return Promise.reject("invalid path of source file");if(!e.lstatSync(r).isFile())return Promise.reject("path of source is not file");if(!xr(n))return Promise.reject("invalid fpSrc");let u=mt(i,"pw","");try{return await async function(r,n,i){return _r((await o.Open.file(r)).files,(async r=>{let o=t.join(n,r.path);return"File"===r.type?async function(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{e.existsSync(t.dirname(n))||e.mkdirSync(t.dirname(n),{recursive:!0});let i=await r.buffer(o);e.writeFileSync(n,i)}catch(t){return Promise.reject(t)}return"done"}(r,o,i):async function(t){try{e.existsSync(t)||e.mkdirSync(t,{recursive:!0})}catch(t){return Promise.reject(t)}return"done"}(o)}))}(r,n,u),Promise.resolve("done: "+wr(n))}catch(t){return Promise.reject(t)}}};function Pr(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var u=t[r];e(u,r,t)&&(i[o++]=u)}return i}function Ar(t,e){var r=[];return ie(t,(function(t,n,o){e(t,n,o)&&r.push(t)})),r}function kr(t){var e=this.__data__=new X(t);this.size=e.size}kr.prototype.clear=function(){this.__data__=new X,this.size=0},kr.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},kr.prototype.get=function(t){return this.__data__.get(t)},kr.prototype.has=function(t){return this.__data__.has(t)},kr.prototype.set=function(t,e){var r=this.__data__;if(r instanceof X){var n=r.__data__;if(!Y||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new et(n)}return r.set(t,e),this.size=r.size,this};function Fr(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new et;++e<r;)this.add(t[e])}function Er(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function $r(t,e){return t.has(e)}Fr.prototype.add=Fr.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Fr.prototype.has=function(t){return this.__data__.has(t)};var Rr=1,Lr=2;function Tr(t,e,r,n,o,i){var u=r&Rr,c=t.length,a=e.length;if(c!=a&&!(u&&a>c))return!1;var f=i.get(t),s=i.get(e);if(f&&s)return f==e&&s==t;var l=-1,p=!0,v=r&Lr?new Fr:void 0;for(i.set(t,e),i.set(e,t);++l<c;){var h=t[l],y=e[l];if(n)var d=u?n(y,h,l,e,t,i):n(h,y,l,t,e,i);if(void 0!==d){if(d)continue;p=!1;break}if(v){if(!Er(e,(function(t,e){if(!$r(v,e)&&(h===t||o(h,t,r,n,i)))return v.push(e)}))){p=!1;break}}else if(h!==y&&!o(h,y,r,n,i)){p=!1;break}}return i.delete(t),i.delete(e),p}var Cr=f.Uint8Array;function Mr(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r}function Dr(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}var Nr=1,qr=2,Ir="[object Boolean]",Br="[object Date]",Ur="[object Error]",Wr="[object Map]",Vr="[object Number]",Zr="[object RegExp]",Gr="[object Set]",Hr="[object String]",Jr="[object Symbol]",Kr="[object ArrayBuffer]",Qr="[object DataView]",Xr=s?s.prototype:void 0,Yr=Xr?Xr.valueOf:void 0;var tn=Object.prototype.propertyIsEnumerable,en=Object.getOwnPropertySymbols,rn=en?function(t){return null==t?[]:(t=Object(t),Pr(en(t),(function(e){return tn.call(t,e)})))}:function(){return[]};function nn(t){return function(t,e,r){var n=e(t);return u(t)?n:function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}(n,r(t))}(t,ne,rn)}var on=1,un=Object.prototype.hasOwnProperty;var cn=1,an="[object Arguments]",fn="[object Array]",sn="[object Object]",ln=Object.prototype.hasOwnProperty;function pn(t,e,r,n,o,i){var c=u(t),a=u(e),f=c?fn:Se(t),s=a?fn:Se(e),l=(f=f==an?sn:f)==sn,p=(s=s==an?sn:s)==sn,v=f==s;if(v&&Tt(t)){if(!Tt(e))return!1;c=!0,l=!1}if(v&&!l)return i||(i=new kr),c||Ht(t)?Tr(t,e,r,n,o,i):function(t,e,r,n,o,i,u){switch(r){case Qr:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Kr:return!(t.byteLength!=e.byteLength||!i(new Cr(t),new Cr(e)));case Ir:case Br:case Vr:return J(+t,+e);case Ur:return t.name==e.name&&t.message==e.message;case Zr:case Hr:return t==e+"";case Wr:var c=Mr;case Gr:var a=n&Nr;if(c||(c=Dr),t.size!=e.size&&!a)return!1;var f=u.get(t);if(f)return f==e;n|=qr,u.set(t,e);var s=Tr(c(t),c(e),n,o,i,u);return u.delete(t),s;case Jr:if(Yr)return Yr.call(t)==Yr.call(e)}return!1}(t,e,f,r,n,o,i);if(!(r&cn)){var h=l&&ln.call(t,"__wrapped__"),y=p&&ln.call(e,"__wrapped__");if(h||y){var d=h?t.value():t,b=y?e.value():e;return i||(i=new kr),o(d,b,r,n,i)}}return!!v&&(i||(i=new kr),function(t,e,r,n,o,i){var u=r&on,c=nn(t),a=c.length;if(a!=nn(e).length&&!u)return!1;for(var f=a;f--;){var s=c[f];if(!(u?s in e:un.call(e,s)))return!1}var l=i.get(t),p=i.get(e);if(l&&p)return l==e&&p==t;var v=!0;i.set(t,e),i.set(e,t);for(var h=u;++f<a;){var y=t[s=c[f]],d=e[s];if(n)var b=u?n(d,y,s,e,t,i):n(y,d,s,t,e,i);if(!(void 0===b?y===d||o(y,d,r,n,i):b)){v=!1;break}h||(h="constructor"==s)}if(v&&!h){var _=t.constructor,j=e.constructor;_==j||!("constructor"in t)||!("constructor"in e)||"function"==typeof _&&_ instanceof _&&"function"==typeof j&&j instanceof j||(v=!1)}return i.delete(t),i.delete(e),v}(t,e,r,n,o,i))}function vn(t,e,r,n,o){return t===e||(null==t||null==e||!g(t)&&!g(e)?t!=t&&e!=e:pn(t,e,r,n,vn,o))}var hn=1,yn=2;function dn(t){return t==t&&!z(t)}function bn(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}}function _n(t){var e=function(t){for(var e=ne(t),r=e.length;r--;){var n=e[r],o=t[n];e[r]=[n,o,dn(o)]}return e}(t);return 1==e.length&&e[0][2]?bn(e[0][0],e[0][1]):function(r){return r===t||function(t,e,r,n){var o=r.length,i=o,u=!n;if(null==t)return!i;for(t=Object(t);o--;){var c=r[o];if(u&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++o<i;){var a=(c=r[o])[0],f=t[a],s=c[1];if(u&&c[2]){if(void 0===f&&!(a in t))return!1}else{var l=new kr;if(n)var p=n(f,s,a,t,e,l);if(!(void 0===p?vn(s,f,hn|yn,n,l):p))return!1}}return!0}(r,t,e)}}function jn(t,e){return null!=t&&e in Object(t)}function gn(t,e){return null!=t&&function(t,e,r){for(var n=-1,o=(e=bt(e,t)).length,i=!1;++n<o;){var c=jt(e[n]);if(!(i=null!=t&&r(t,c)))break;t=t[c]}return i||++n!=o?i:!!(o=null==t?0:t.length)&&qt(o)&&Dt(c,o)&&(u(t)||Et(t))}(t,e,jn)}var mn=1,wn=2;function Sn(t){return x(t)?xe(jt(t)):function(t){return function(e){return gt(e,t)}}(t)}function On(t){return"function"==typeof t?t:null==t?ue:"object"==typeof t?u(t)?function(t,e){return x(t)&&dn(e)?bn(jt(t),e):function(r){var n=mt(r,t);return void 0===n&&n===e?gn(r,t):vn(e,n,mn|wn)}}(t[0],t[1]):_n(t):Sn(t)}function xn(t,e){var r=-1,n=re(t)?Array(t.length):[];return ie(t,(function(t,o,i){n[++r]=e(t,o,i)})),n}var zn=Array.prototype.join;function Pn(t,e){return new Promise((function(r,n){Ve(e)||(e=[e]);let o=i.spawnSync(t,e),c=(a=o.output,f=t=>null!==t,(u(a)?Pr:Ar)(a,On(f)));var a,f;c=function(t,e){return(u(t)?lt:xn)(t,On(e))}(c,(t=>function(t){try{return t.toString("utf8")}catch(t){}return""}(t)));let s=(p="",null==(l=c)?"":zn.call(l,p));var l,p;let v=mt(o,"error.message");v?n(v):r(s)}))}var An=function(){let t="C:\\Program Files\\7-Zip\\7z.exe";async function r(e,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=["a",r,e,`-mx${arguments.length>2&&void 0!==arguments[2]?arguments[2]:9}`];return""!==n&&o.push(`-p${n}`),Pn(t,o)}return{setProg:function(r){return e.existsSync(r)?e.lstatSync(r).isFile()?{error:"path of 7z is not file"}:(t=r,{success:"done: "+r}):{error:"invalid path of 7z"}},zipFile:async function(t,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(t))return Promise.reject("invalid path of source file");if(!e.lstatSync(t).isFile())return Promise.reject("path of source is not file");if(!xr(n))return Promise.reject("invalid fpSrc");let i=mt(o,"level",9),u=mt(o,"pw",""),c=null,a=await r(t,n,i,u).catch((t=>{c=t}));return c?Promise.reject(c):{state:"finish: "+n,msg7z:a}},zipFolder:async function(t,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(t))return Promise.reject("invalid path of source file");if(!e.lstatSync(t).isDirectory())return Promise.reject("path of source is not folder");if(!xr(n))return Promise.reject("invalid fpSrc");let i=mt(o,"level",9),u=mt(o,"pw",""),c=null,a=await r(t,n,i,u).catch((t=>{c=t}));return c?Promise.reject(c):{state:"finish: "+n,msg7z:a}},unzip:async function(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(r))return Promise.reject("invalid path of source file");if(!e.lstatSync(r).isFile())return Promise.reject("path of source is not file");if(!xr(n))return Promise.reject("invalid fpSrc");let i=mt(o,"pw",""),u=["x",r,"-o"+n];""!==i&&u.push(`-p${i}`);let c=null,a=await Pn(t,u).catch((t=>{c=t}));return c?Promise.reject(c):{state:"finish: "+wr(n),msg7z:a}}}}();return{mZip:zr,m7z:An}}));
//# sourceMappingURL=w-zip.umd.js.map
