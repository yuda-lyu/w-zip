/*!
 * w-zip v1.0.21
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("path"),require("fs"),require("archiver"),require("archiver-zip-encrypted"),require("unzipper"),require("child_process")):"function"==typeof define&&define.amd?define(["path","fs","archiver","archiver-zip-encrypted","unzipper","child_process"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-zip"]=e(t.path,t.fs,t.archiver,t["archiver-zip-encrypted"],t.unzipper,t.child_process)}(this,(function(t,e,r,n,o,i){"use strict";var c=Array.isArray,u="object"==typeof global&&global&&global.Object===Object&&global,s="object"==typeof self&&self&&self.Object===Object&&self,a=u||s||Function("return this")(),f=a.Symbol,l=Object.prototype,p=l.hasOwnProperty,h=l.toString,v=f?f.toStringTag:void 0;var y=Object.prototype.toString;var d="[object Null]",b="[object Undefined]",j=f?f.toStringTag:void 0;function g(t){return null==t?void 0===t?b:d:j&&j in Object(t)?function(t){var e=p.call(t,v),r=t[v];try{t[v]=void 0;var n=!0}catch(t){}var o=h.call(t);return n&&(e?t[v]=r:delete t[v]),o}(t):function(t){return y.call(t)}(t)}function m(t){return null!=t&&"object"==typeof t}var _="[object Symbol]";function S(t){return"symbol"==typeof t||m(t)&&g(t)==_}var w=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,x=/^\w*$/;function O(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var P="[object AsyncFunction]",z="[object Function]",F="[object GeneratorFunction]",A="[object Proxy]";function k(t){if(!O(t))return!1;var e=g(t);return e==z||e==F||e==P||e==A}var $,E=a["__core-js_shared__"],C=($=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+$:"";var R=Function.prototype.toString;function T(t){if(null!=t){try{return R.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var M=/^\[object .+?Constructor\]$/,N=Function.prototype,q=Object.prototype,L=N.toString,D=q.hasOwnProperty,I=RegExp("^"+L.call(D).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function B(t){return!(!O(t)||(e=t,C&&C in e))&&(k(t)?I:M).test(T(t));var e}function U(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return B(r)?r:void 0}var W=U(Object,"create");var V=Object.prototype.hasOwnProperty;var Z=Object.prototype.hasOwnProperty;function G(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function H(t,e){for(var r,n,o=t.length;o--;)if((r=t[o][0])===(n=e)||r!=r&&n!=n)return o;return-1}G.prototype.clear=function(){this.__data__=W?W(null):{},this.size=0},G.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},G.prototype.get=function(t){var e=this.__data__;if(W){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return V.call(e,t)?e[t]:void 0},G.prototype.has=function(t){var e=this.__data__;return W?void 0!==e[t]:Z.call(e,t)},G.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=W&&void 0===e?"__lodash_hash_undefined__":e,this};var J=Array.prototype.splice;function K(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}K.prototype.clear=function(){this.__data__=[],this.size=0},K.prototype.delete=function(t){var e=this.__data__,r=H(e,t);return!(r<0)&&(r==e.length-1?e.pop():J.call(e,r,1),--this.size,!0)},K.prototype.get=function(t){var e=this.__data__,r=H(e,t);return r<0?void 0:e[r][1]},K.prototype.has=function(t){return H(this.__data__,t)>-1},K.prototype.set=function(t,e){var r=this.__data__,n=H(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var Q=U(a,"Map");function X(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function Y(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Y.prototype.clear=function(){this.size=0,this.__data__={hash:new G,map:new(Q||K),string:new G}},Y.prototype.delete=function(t){var e=X(this,t).delete(t);return this.size-=e?1:0,e},Y.prototype.get=function(t){return X(this,t).get(t)},Y.prototype.has=function(t){return X(this,t).has(t)},Y.prototype.set=function(t,e){var r=X(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};var tt="Expected a function";function et(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(tt);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var c=t.apply(this,n);return r.cache=i.set(o,c)||i,c};return r.cache=new(et.Cache||Y),r}et.Cache=Y;var rt,nt,ot,it=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ct=/\\(\\)?/g,ut=(rt=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(it,(function(t,r,n,o){e.push(n?o.replace(ct,"$1"):r||t)})),e},nt=et(rt,(function(t){return 500===ot.size&&ot.clear(),t})),ot=nt.cache,nt),st=ut;function at(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}var ft=1/0,lt=f?f.prototype:void 0,pt=lt?lt.toString:void 0;function ht(t){if("string"==typeof t)return t;if(c(t))return at(t,ht)+"";if(S(t))return pt?pt.call(t):"";var e=t+"";return"0"==e&&1/t==-ft?"-0":e}function vt(t){return null==t?"":ht(t)}function yt(t,e){return c(t)?t:function(t,e){if(c(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!S(t))||x.test(t)||!w.test(t)||null!=e&&t in Object(e)}(t,e)?[t]:st(vt(t))}var dt=1/0;function bt(t){if("string"==typeof t||S(t))return t;var e=t+"";return"0"==e&&1/t==-dt?"-0":e}function jt(t,e,r){var n=null==t?void 0:function(t,e){for(var r=0,n=(e=yt(e,t)).length;null!=t&&r<n;)t=t[bt(e[r++])];return r&&r==n?t:void 0}(t,e);return void 0===n?r:n}function gt(){let t,e,r=new Promise((function(){t=arguments[0],e=arguments[1]}));return r.resolve=t,r.reject=e,r}function mt(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t}var _t,St=function(t,e,r){for(var n=-1,o=Object(t),i=r(t),c=i.length;c--;){var u=i[_t?c:++n];if(!1===e(o[u],u,o))break}return t},wt=St;function xt(t){return m(t)&&"[object Arguments]"==g(t)}var Ot=Object.prototype,Pt=Ot.hasOwnProperty,zt=Ot.propertyIsEnumerable,Ft=xt(function(){return arguments}())?xt:function(t){return m(t)&&Pt.call(t,"callee")&&!zt.call(t,"callee")},At=Ft;var kt="object"==typeof exports&&exports&&!exports.nodeType&&exports,$t=kt&&"object"==typeof module&&module&&!module.nodeType&&module,Et=$t&&$t.exports===kt?a.Buffer:void 0,Ct=(Et?Et.isBuffer:void 0)||function(){return!1},Rt=9007199254740991,Tt=/^(?:0|[1-9]\d*)$/;function Mt(t,e){var r=typeof t;return!!(e=null==e?Rt:e)&&("number"==r||"symbol"!=r&&Tt.test(t))&&t>-1&&t%1==0&&t<e}var Nt=9007199254740991;function qt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Nt}var Lt={};Lt["[object Float32Array]"]=Lt["[object Float64Array]"]=Lt["[object Int8Array]"]=Lt["[object Int16Array]"]=Lt["[object Int32Array]"]=Lt["[object Uint8Array]"]=Lt["[object Uint8ClampedArray]"]=Lt["[object Uint16Array]"]=Lt["[object Uint32Array]"]=!0,Lt["[object Arguments]"]=Lt["[object Array]"]=Lt["[object ArrayBuffer]"]=Lt["[object Boolean]"]=Lt["[object DataView]"]=Lt["[object Date]"]=Lt["[object Error]"]=Lt["[object Function]"]=Lt["[object Map]"]=Lt["[object Number]"]=Lt["[object Object]"]=Lt["[object RegExp]"]=Lt["[object Set]"]=Lt["[object String]"]=Lt["[object WeakMap]"]=!1;var Dt="object"==typeof exports&&exports&&!exports.nodeType&&exports,It=Dt&&"object"==typeof module&&module&&!module.nodeType&&module,Bt=It&&It.exports===Dt&&u.process,Ut=function(){try{var t=It&&It.require&&It.require("util").types;return t||Bt&&Bt.binding&&Bt.binding("util")}catch(t){}}(),Wt=Ut&&Ut.isTypedArray,Vt=Wt?function(t){return function(e){return t(e)}}(Wt):function(t){return m(t)&&qt(t.length)&&!!Lt[g(t)]},Zt=Vt,Gt=Object.prototype.hasOwnProperty;function Ht(t,e){var r=c(t),n=!r&&At(t),o=!r&&!n&&Ct(t),i=!r&&!n&&!o&&Zt(t),u=r||n||o||i,s=u?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],a=s.length;for(var f in t)!e&&!Gt.call(t,f)||u&&("length"==f||o&&("offset"==f||"parent"==f)||i&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||Mt(f,a))||s.push(f);return s}var Jt=Object.prototype;var Kt=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),Qt=Kt,Xt=Object.prototype.hasOwnProperty;function Yt(t){if(r=(e=t)&&e.constructor,e!==("function"==typeof r&&r.prototype||Jt))return Qt(t);var e,r,n=[];for(var o in Object(t))Xt.call(t,o)&&"constructor"!=o&&n.push(o);return n}function te(t){return null!=t&&qt(t.length)&&!k(t)}function ee(t){return te(t)?Ht(t):Yt(t)}var re=function(t,e){return function(r,n){if(null==r)return r;if(!te(r))return t(r,n);for(var o=r.length,i=e?o:-1,c=Object(r);(e?i--:++i<o)&&!1!==n(c[i],i,c););return r}}((function(t,e){return t&&wt(t,e,ee)})),ne=re;function oe(t){return t}function ie(t,e){var r;return(c(t)?mt:ne)(t,"function"==typeof(r=e)?r:oe)}var ce=U(a,"DataView"),ue=U(a,"Promise"),se=U(a,"Set"),ae=U(a,"WeakMap"),fe="[object Map]",le="[object Promise]",pe="[object Set]",he="[object WeakMap]",ve="[object DataView]",ye=T(ce),de=T(Q),be=T(ue),je=T(se),ge=T(ae),me=g;(ce&&me(new ce(new ArrayBuffer(1)))!=ve||Q&&me(new Q)!=fe||ue&&me(ue.resolve())!=le||se&&me(new se)!=pe||ae&&me(new ae)!=he)&&(me=function(t){var e=g(t),r="[object Object]"==e?t.constructor:void 0,n=r?T(r):"";if(n)switch(n){case ye:return ve;case de:return fe;case be:return le;case je:return pe;case ge:return he}return e});var _e=me,Se="[object String]";var we,xe=(we="length",function(t){return null==t?void 0:t[we]}),Oe=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Pe="\\ud800-\\udfff",ze="["+Pe+"]",Fe="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Ae="\\ud83c[\\udffb-\\udfff]",ke="[^"+Pe+"]",$e="(?:\\ud83c[\\udde6-\\uddff]){2}",Ee="[\\ud800-\\udbff][\\udc00-\\udfff]",Ce="(?:"+Fe+"|"+Ae+")"+"?",Re="[\\ufe0e\\ufe0f]?",Te=Re+Ce+("(?:\\u200d(?:"+[ke,$e,Ee].join("|")+")"+Re+Ce+")*"),Me="(?:"+[ke+Fe+"?",Fe,$e,Ee,ze].join("|")+")",Ne=RegExp(Ae+"(?="+Ae+")|"+Me+Te,"g");function qe(t){return function(t){return Oe.test(t)}(t)?function(t){for(var e=Ne.lastIndex=0;Ne.test(t);)++e;return e}(t):xe(t)}var Le="[object Map]",De="[object Set]";function Ie(t){if(null==t)return 0;if(te(t))return"string"==typeof(e=t)||!c(e)&&m(e)&&g(e)==Se?qe(t):t.length;var e,r=_e(t);return r==Le||r==De?t.size:Yt(t).length}function Be(t){return null==t?[]:function(t,e){return at(e,(function(e){return t[e]}))}(t,ee(t))}function Ue(t){return"[object Array]"===Object.prototype.toString.call(t)}function We(t){return"[object Object]"===Object.prototype.toString.call(t)}function Ve(t){let e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}var Ze={};!function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}function o(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function i(t,e,n,i,c){if("function"!=typeof n)throw new TypeError("The listener must be a function");var u=new o(n,i||t,c),s=r?r+e:e;return t._events[s]?t._events[s].fn?t._events[s]=[t._events[s],u]:t._events[s].push(u):(t._events[s]=u,t._eventsCount++),t}function c(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function u(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),u.prototype.eventNames=function(){var t,n,o=[];if(0===this._eventsCount)return o;for(n in t=this._events)e.call(t,n)&&o.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},u.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,c=new Array(i);o<i;o++)c[o]=n[o].fn;return c},u.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},u.prototype.emit=function(t,e,n,o,i,c){var u=r?r+t:t;if(!this._events[u])return!1;var s,a,f=this._events[u],l=arguments.length;if(f.fn){switch(f.once&&this.removeListener(t,f.fn,void 0,!0),l){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,e),!0;case 3:return f.fn.call(f.context,e,n),!0;case 4:return f.fn.call(f.context,e,n,o),!0;case 5:return f.fn.call(f.context,e,n,o,i),!0;case 6:return f.fn.call(f.context,e,n,o,i,c),!0}for(a=1,s=new Array(l-1);a<l;a++)s[a-1]=arguments[a];f.fn.apply(f.context,s)}else{var p,h=f.length;for(a=0;a<h;a++)switch(f[a].once&&this.removeListener(t,f[a].fn,void 0,!0),l){case 1:f[a].fn.call(f[a].context);break;case 2:f[a].fn.call(f[a].context,e);break;case 3:f[a].fn.call(f[a].context,e,n);break;case 4:f[a].fn.call(f[a].context,e,n,o);break;default:if(!s)for(p=1,s=new Array(l-1);p<l;p++)s[p-1]=arguments[p];f[a].fn.apply(f[a].context,s)}}return!0},u.prototype.on=function(t,e,r){return i(this,t,e,r,!1)},u.prototype.once=function(t,e,r){return i(this,t,e,r,!0)},u.prototype.removeListener=function(t,e,n,o){var i=r?r+t:t;if(!this._events[i])return this;if(!e)return c(this,i),this;var u=this._events[i];if(u.fn)u.fn!==e||o&&!u.once||n&&u.context!==n||c(this,i);else{for(var s=0,a=[],f=u.length;s<f;s++)(u[s].fn!==e||o&&!u[s].once||n&&u[s].context!==n)&&a.push(u[s]);a.length?this._events[i]=1===a.length?a[0]:a:c(this,i)}return this},u.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&c(this,e)):(this._events=new n,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=r,u.EventEmitter=u,t.exports=u}({get exports(){return Ze},set exports(t){Ze=t}});var Ge=Ze;var He=/\s/;var Je=/^\s+/;function Ke(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&He.test(t.charAt(e)););return e}(t)+1).replace(Je,""):t}var Qe=NaN,Xe=/^[-+]0x[0-9a-f]+$/i,Ye=/^0b[01]+$/i,tr=/^0o[0-7]+$/i,er=parseInt;function rr(t){if("number"==typeof t)return t;if(S(t))return Qe;if(O(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=O(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Ke(t);var r=Ye.test(t);return r||tr.test(t)?er(t.slice(2),r?2:8):Xe.test(t)?Qe:+t}var nr=1/0,or=17976931348623157e292;function ir(t){return t?(t=rr(t))===nr||t===-nr?(t<0?-1:1)*or:t==t?t:0:0===t?t:0}function cr(t){var e=ir(t),r=e%1;return e==e?r?e-r:e:0}function ur(t){return"[object String]"===Object.prototype.toString.call(t)}function sr(t){return!(!ur(t)||""===t)}function ar(t){return t!=t}function fr(t){let e=!1;if(sr(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(ar(t))return!1;e=!0}return e}function lr(t){if(!fr(t))return 0;return ir(t)}function pr(t){return!!fr(t)&&(t=lr(t),"number"==typeof(e=t)&&e==cr(e));var e}var hr=a.isFinite,vr=Math.min;var yr=function(t){var e=Math[t];return function(t,r){if(t=rr(t),(r=null==r?0:vr(cr(r),292))&&hr(t)){var n=(vt(t)+"e").split("e");return+((n=(vt(e(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}("round"),dr=yr;function br(t){if(!fr(t))return 0;t=lr(t);let e=dr(t);return"0"===String(e)?0:e}function jr(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=0,r=[];var n;pr(n=t)&&br(n)<0&&(t=0),t=br(t);let o=new Ge;return o.get=function(){if(r.length>0){return e+=1,r.splice(0,1)[0]}return null},o.cb=function(){e-=1,e<0&&(e=0),r.length>0&&o.emit("message",r)},o.push=function(n){r.push(n),(t<=0||e<t)&&o.emit("message",r)},o.clear=function(){e=0,r=[]},o}function gr(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n={},o=!1,i=gt();if(!Ue(t)&&!We(t))return i.reject("rs is not an array or object"),i;let c=!1;if(We(t)){c=!0;let e=[];ie(t,((t,r)=>{e.push({k:r,v:t})})),t=e}let u=jr(r);return u.on("message",(function(r){if(o)return;let s,a=u.get();if(Ve(e)){let t=a.key,r=a.value;if(c&&(t=a.value.k,r=a.value.v),s=e(r,t),!function(t){let e,r=Object.prototype.toString.call(t);if(e="[object Promise]"===r,e)return!0;if("[object Function]"!==r)return!1;try{e="function"!=typeof t.subscribe&&"function"==typeof t.then}catch(t){}return e}(s))throw new Error("return of fun is not a promise")}else s=a.value;s.then((t=>{n[a.key]=t})).catch((t=>{o=!0,u.clear(),i.reject(t)})).finally((()=>{u.cb(),Ie(n)===Ie(t)&&i.resolve(Be(n))}))})),ie(t,((t,e)=>{u.push({key:e,value:t})})),i}function mr(t){if(!pr(t))return!1;return br(t)>=0}function _r(t,e){if(!sr(t))return"";if(!mr(e))return"";if(0===(e=br(e)))return"";let r=t.length-e;return r<0&&(r=0),t.substring(r,r+e)}function Sr(t,e){return sr(t)&&mr(e)?0===(e=br(e))?"":t.substring(0,e):""}function wr(t,e){return sr(t)&&mr(e)?0===(e=br(e))?t:Sr(t,t.length-e):""}function xr(t){if(!sr(t))return"";let e=function(t){if(!sr(t))return{path:"",isRoot:!1};for(;t.indexOf("\\\\")>=0;)t=t.replace("\\\\","\\");for(;t.indexOf("//")>=0;)t=t.replace("//","/");if(":"===_r(t,1))return{path:`${t}\\`,isRoot:!0};if("\\"===_r(t,1)){let e=wr(t,1);return":"===_r(e,1)?{path:t,isRoot:!0}:{path:e,isRoot:!1}}if("/"===_r(t,1)){let e=wr(t,1);return 0===e.length?{path:t,isRoot:!0}:{path:e,isRoot:!1}}return{path:t,isRoot:!1}}(t);if(e.isRoot)return e.path;let r=e.path;try{r=r.split("\\").pop().split("/").pop()}catch(t){}return r}function Or(t){return function(t){let e=jt(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"fs");return!!e.existsSync(t)&&!e.lstatSync(t).isDirectory()&&!e.lstatSync(t).isSymbolicLink()}(t,{fs:e})}function Pr(t){let e=jt(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"fs");if(!e.existsSync(t))return!1;let r=e.lstatSync(t);return!r.isFile()&&!r.isSymbolicLink()}function zr(t){return function(t){let e=jt(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"fs");if(!e.existsSync(t))return{success:"folder does not exist: "+t};if(!Pr(t,{fs:e}))return{error:"input path is not a folder: "+t};try{e.rmSync(t,{recursive:!0,force:!0})}catch(t){return{error:t}}return{success:"done: "+t}}(t,{fs:e})}async function Fr(t){try{Or(t)?e.unlinkSync(t):Pr(t,{fs:e})&&zr(t),e.writeFileSync(t,"test","utf8"),e.unlinkSync(t)}catch(t){return!1}return!0}r.registerFormat("zip-encrypted",n);var Ar={zipFile:async function(n,o){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(n))return Promise.reject("invalid path of source file");if(!e.lstatSync(n).isFile())return Promise.reject("path of source is not file");if(!Fr(o))return Promise.reject("invalid fpSrc");let c=jt(i,"level",9),u=jt(i,"pw","");try{let i=gt();e.existsSync(t.dirname(o))||e.mkdirSync(t.dirname(o),{recursive:!0});let s,a=e.createWriteStream(o);return s=""===u?r("zip",{zlib:{level:c}}):r("zip-encrypted",{zlib:{level:c},encryptionMethod:"zip20",password:u}),a.on("close",(function(){i.resolve("done: "+o)})),s.on("warning",(function(t){})),s.on("error",(function(t){Promise.reject(t)})),s.pipe(a),s.file(n,{name:t.basename(n)}),s.finalize(),i}catch(t){return Promise.reject(t)}},zipFolder:async function(n,o){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(n))return Promise.reject("invalid path of source file");if(!e.lstatSync(n).isDirectory())return Promise.reject("path of source is not folder");if(!Fr(o))return Promise.reject("invalid fpSrc");let c=jt(i,"level",9),u=jt(i,"pw","");try{let i=gt();e.existsSync(t.dirname(o))||e.mkdirSync(t.dirname(o),{recursive:!0});let s,a=e.createWriteStream(o);return s=""===u?r("zip",{zlib:{level:c}}):r("zip-encrypted",{zlib:{level:c},encryptionMethod:"zip20",password:u}),a.on("close",(function(){i.resolve("done: "+o)})),s.on("warning",(function(t){})),s.on("error",(function(t){Promise.reject(t)})),s.pipe(a),s.directory(n,t.basename(n)),s.finalize(),i}catch(t){return Promise.reject(t)}},unzip:async function(r,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(r))return Promise.reject("invalid path of source file");if(!e.lstatSync(r).isFile())return Promise.reject("path of source is not file");if(!Fr(n))return Promise.reject("invalid fpSrc");let c=jt(i,"pw","");try{return await async function(r,n,i){return gr((await o.Open.file(r)).files,(async r=>{let o=t.join(n,r.path);return"File"===r.type?async function(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{e.existsSync(t.dirname(n))||e.mkdirSync(t.dirname(n),{recursive:!0});let i=await r.buffer(o);e.writeFileSync(n,i)}catch(t){return Promise.reject(t)}return"done"}(r,o,i):async function(t){try{e.existsSync(t)||e.mkdirSync(t,{recursive:!0})}catch(t){return Promise.reject(t)}return"done"}(o)}))}(r,n,c),Promise.resolve("done: "+xr(n))}catch(t){return Promise.reject(t)}}};function kr(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(We(t)){for(let e in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!ur(t)||""!==t)}(t)||(!!function(t){return!!Ue(t)&&0===t.length}(t)||!!ar(t)))))}var $r="[object Boolean]";function Er(t){return!0===(e=t)||!1===e||m(e)&&g(e)==$r;var e}function Cr(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if((!Ue(n=e)||0===n.length||1===n.length&&kr(n[0]))&&!sr(e))throw new Error("args is not an effective array or string");var n;sr(e)&&(e=[e]);let o=jt(r,"mode");"spawn"!==o&&"exec"!==o&&"execFile"!==o&&(o="spawn");let c=jt(r,"cbStdout"),u=jt(r,"cbStderr"),s=jt(r,"codeCmd");sr(s)||(s="utf8");let a=jt(r,"useChcp");Er(a)||(a=!1);let f=gt(),l="",p="",h=null;if("spawn"===o){let r=Sr(t,1),n=_r(t,1);if('"'===r||'"'===n||"'"===r||"'"===n)throw new Error("prog of spawn doens not need to add quotes");h=i.spawn(t,e,{encoding:s,shell:!1})}else if("exec"===o){let r="";a&&(r="cmd /c chcp 65001>nul &&"),h=i.exec(`${r} ${t} ${e.join(" ")} & exit`,{encoding:s})}else{if("execFile"!==o)throw new Error(`invalid mode[${o}]`);h=i.execFile(t,e,{encoding:s})}return h.stdout.on("data",(t=>{let e=t.toString().trim();l+=e+"\n",Ve(c)&&c(e)})),h.stderr.on("data",(t=>{let e=t.toString().trim();p+=e+"\n",Ve(u)&&u(e)})),h.on("close",(t=>{sr(p)?f.reject(p):f.resolve(l)})),h.on("error",(t=>{f.reject(t)})),f}var Rr=function(){let t="C:\\Program Files\\7-Zip\\7z.exe";async function r(e,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=["a",r,e,`-mx${arguments.length>2&&void 0!==arguments[2]?arguments[2]:9}`];return""!==n&&o.push(`-p${n}`),await Cr(t,o)}return{setProg:function(r){return e.existsSync(r)?e.lstatSync(r).isFile()?{error:"path of 7z is not file"}:(t=r,{success:"done: "+r}):{error:"invalid path of 7z"}},zipFile:async function(t,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(t))return Promise.reject("invalid path of source file");if(!e.lstatSync(t).isFile())return Promise.reject("path of source is not file");if(!Fr(n))return Promise.reject("invalid fpSrc");let i=jt(o,"level",9),c=jt(o,"pw",""),u=null,s=await r(t,n,i,c).catch((t=>{u=t}));return u?Promise.reject(u):{state:"finish: "+n,msg7z:s}},zipFolder:async function(t,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(t))return Promise.reject("invalid path of source file");if(!e.lstatSync(t).isDirectory())return Promise.reject("path of source is not folder");if(!Fr(n))return Promise.reject("invalid fpSrc");let i=jt(o,"level",9),c=jt(o,"pw",""),u=null,s=await r(t,n,i,c).catch((t=>{u=t}));return u?Promise.reject(u):{state:"finish: "+n,msg7z:s}},unzip:async function(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(r))return Promise.reject("invalid path of source file");if(!e.lstatSync(r).isFile())return Promise.reject("path of source is not file");if(!Fr(n))return Promise.reject("invalid fpSrc");let i=jt(o,"pw",""),c=["x",r,"-o"+n];""!==i&&c.push(`-p${i}`);let u=null,s=await Cr(t,c).catch((t=>{u=t}));return u?Promise.reject(u):{state:"finish: "+xr(n),msg7z:s}}}}();return{mZip:Ar,m7z:Rr}}));
//# sourceMappingURL=w-zip.umd.js.map
