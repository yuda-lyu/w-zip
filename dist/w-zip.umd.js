/*!
 * w-zip v1.0.22
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("path"),require("fs"),require("archiver"),require("archiver-zip-encrypted"),require("unzipper"),require("child_process")):"function"==typeof define&&define.amd?define(["path","fs","archiver","archiver-zip-encrypted","unzipper","child_process"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-zip"]=e(t.path,t.fs,t.archiver,t["archiver-zip-encrypted"],t.unzipper,t.child_process)}(this,(function(t,e,r,n,o,i){"use strict";var c=Array.isArray,u="object"==typeof global&&global&&global.Object===Object&&global,a="object"==typeof self&&self&&self.Object===Object&&self,s=u||a||Function("return this")(),f=s.Symbol,l=Object.prototype,p=l.hasOwnProperty,h=l.toString,v=f?f.toStringTag:void 0;var y=Object.prototype.toString;var d="[object Null]",b="[object Undefined]",g=f?f.toStringTag:void 0;function j(t){return null==t?void 0===t?b:d:g&&g in Object(t)?function(t){var e=p.call(t,v),r=t[v];try{t[v]=void 0;var n=!0}catch(t){}var o=h.call(t);return n&&(e?t[v]=r:delete t[v]),o}(t):function(t){return y.call(t)}(t)}function _(t){return null!=t&&"object"==typeof t}var m="[object Symbol]";function w(t){return"symbol"==typeof t||_(t)&&j(t)==m}var S=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,x=/^\w*$/;function O(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var z="[object AsyncFunction]",P="[object Function]",A="[object GeneratorFunction]",F="[object Proxy]";function k(t){if(!O(t))return!1;var e=j(t);return e==P||e==A||e==z||e==F}var $,E=s["__core-js_shared__"],C=($=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+$:"";var R=Function.prototype.toString;function L(t){if(null!=t){try{return R.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var T=/^\[object .+?Constructor\]$/,M=Function.prototype,N=Object.prototype,q=M.toString,D=N.hasOwnProperty,B=RegExp("^"+q.call(D).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function I(t){return!(!O(t)||(e=t,C&&C in e))&&(k(t)?B:T).test(L(t));var e}function U(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return I(r)?r:void 0}var W=U(Object,"create");var V=Object.prototype.hasOwnProperty;var H=Object.prototype.hasOwnProperty;function Z(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function G(t,e){return t===e||t!=t&&e!=e}function J(t,e){for(var r=t.length;r--;)if(G(t[r][0],e))return r;return-1}Z.prototype.clear=function(){this.__data__=W?W(null):{},this.size=0},Z.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Z.prototype.get=function(t){var e=this.__data__;if(W){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return V.call(e,t)?e[t]:void 0},Z.prototype.has=function(t){var e=this.__data__;return W?void 0!==e[t]:H.call(e,t)},Z.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=W&&void 0===e?"__lodash_hash_undefined__":e,this};var K=Array.prototype.splice;function Q(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Q.prototype.clear=function(){this.__data__=[],this.size=0},Q.prototype.delete=function(t){var e=this.__data__,r=J(e,t);return!(r<0)&&(r==e.length-1?e.pop():K.call(e,r,1),--this.size,!0)},Q.prototype.get=function(t){var e=this.__data__,r=J(e,t);return r<0?void 0:e[r][1]},Q.prototype.has=function(t){return J(this.__data__,t)>-1},Q.prototype.set=function(t,e){var r=this.__data__,n=J(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var X=U(s,"Map");function Y(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function tt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}tt.prototype.clear=function(){this.size=0,this.__data__={hash:new Z,map:new(X||Q),string:new Z}},tt.prototype.delete=function(t){var e=Y(this,t).delete(t);return this.size-=e?1:0,e},tt.prototype.get=function(t){return Y(this,t).get(t)},tt.prototype.has=function(t){return Y(this,t).has(t)},tt.prototype.set=function(t,e){var r=Y(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};var et="Expected a function";function rt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(et);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var c=t.apply(this,n);return r.cache=i.set(o,c)||i,c};return r.cache=new(rt.Cache||tt),r}rt.Cache=tt;var nt,ot,it,ct=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ut=/\\(\\)?/g,at=(nt=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(ct,(function(t,r,n,o){e.push(n?o.replace(ut,"$1"):r||t)})),e},ot=rt(nt,(function(t){return 500===it.size&&it.clear(),t})),it=ot.cache,ot),st=at;function ft(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}var lt=1/0,pt=f?f.prototype:void 0,ht=pt?pt.toString:void 0;function vt(t){if("string"==typeof t)return t;if(c(t))return ft(t,vt)+"";if(w(t))return ht?ht.call(t):"";var e=t+"";return"0"==e&&1/t==-lt?"-0":e}function yt(t){return null==t?"":vt(t)}function dt(t,e){return c(t)?t:function(t,e){if(c(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!w(t))||x.test(t)||!S.test(t)||null!=e&&t in Object(e)}(t,e)?[t]:st(yt(t))}var bt=1/0;function gt(t){if("string"==typeof t||w(t))return t;var e=t+"";return"0"==e&&1/t==-bt?"-0":e}function jt(t,e,r){var n=null==t?void 0:function(t,e){for(var r=0,n=(e=dt(e,t)).length;null!=t&&r<n;)t=t[gt(e[r++])];return r&&r==n?t:void 0}(t,e);return void 0===n?r:n}function _t(){let t,e,r=new Promise((function(){t=arguments[0],e=arguments[1]}));return r.resolve=t,r.reject=e,r}function mt(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t}var wt,St=function(t,e,r){for(var n=-1,o=Object(t),i=r(t),c=i.length;c--;){var u=i[wt?c:++n];if(!1===e(o[u],u,o))break}return t},xt=St;function Ot(t){return _(t)&&"[object Arguments]"==j(t)}var zt=Object.prototype,Pt=zt.hasOwnProperty,At=zt.propertyIsEnumerable,Ft=Ot(function(){return arguments}())?Ot:function(t){return _(t)&&Pt.call(t,"callee")&&!At.call(t,"callee")},kt=Ft;var $t="object"==typeof exports&&exports&&!exports.nodeType&&exports,Et=$t&&"object"==typeof module&&module&&!module.nodeType&&module,Ct=Et&&Et.exports===$t?s.Buffer:void 0,Rt=(Ct?Ct.isBuffer:void 0)||function(){return!1},Lt=9007199254740991,Tt=/^(?:0|[1-9]\d*)$/;function Mt(t,e){var r=typeof t;return!!(e=null==e?Lt:e)&&("number"==r||"symbol"!=r&&Tt.test(t))&&t>-1&&t%1==0&&t<e}var Nt=9007199254740991;function qt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Nt}var Dt={};Dt["[object Float32Array]"]=Dt["[object Float64Array]"]=Dt["[object Int8Array]"]=Dt["[object Int16Array]"]=Dt["[object Int32Array]"]=Dt["[object Uint8Array]"]=Dt["[object Uint8ClampedArray]"]=Dt["[object Uint16Array]"]=Dt["[object Uint32Array]"]=!0,Dt["[object Arguments]"]=Dt["[object Array]"]=Dt["[object ArrayBuffer]"]=Dt["[object Boolean]"]=Dt["[object DataView]"]=Dt["[object Date]"]=Dt["[object Error]"]=Dt["[object Function]"]=Dt["[object Map]"]=Dt["[object Number]"]=Dt["[object Object]"]=Dt["[object RegExp]"]=Dt["[object Set]"]=Dt["[object String]"]=Dt["[object WeakMap]"]=!1;var Bt="object"==typeof exports&&exports&&!exports.nodeType&&exports,It=Bt&&"object"==typeof module&&module&&!module.nodeType&&module,Ut=It&&It.exports===Bt&&u.process,Wt=function(){try{var t=It&&It.require&&It.require("util").types;return t||Ut&&Ut.binding&&Ut.binding("util")}catch(t){}}(),Vt=Wt&&Wt.isTypedArray,Ht=Vt?function(t){return function(e){return t(e)}}(Vt):function(t){return _(t)&&qt(t.length)&&!!Dt[j(t)]},Zt=Ht,Gt=Object.prototype.hasOwnProperty;function Jt(t,e){var r=c(t),n=!r&&kt(t),o=!r&&!n&&Rt(t),i=!r&&!n&&!o&&Zt(t),u=r||n||o||i,a=u?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],s=a.length;for(var f in t)!e&&!Gt.call(t,f)||u&&("length"==f||o&&("offset"==f||"parent"==f)||i&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||Mt(f,s))||a.push(f);return a}var Kt=Object.prototype;var Qt=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),Xt=Qt,Yt=Object.prototype.hasOwnProperty;function te(t){if(r=(e=t)&&e.constructor,e!==("function"==typeof r&&r.prototype||Kt))return Xt(t);var e,r,n=[];for(var o in Object(t))Yt.call(t,o)&&"constructor"!=o&&n.push(o);return n}function ee(t){return null!=t&&qt(t.length)&&!k(t)}function re(t){return ee(t)?Jt(t):te(t)}var ne=function(t,e){return function(r,n){if(null==r)return r;if(!ee(r))return t(r,n);for(var o=r.length,i=e?o:-1,c=Object(r);(e?i--:++i<o)&&!1!==n(c[i],i,c););return r}}((function(t,e){return t&&xt(t,e,re)})),oe=ne;function ie(t){return t}function ce(t,e){var r;return(c(t)?mt:oe)(t,"function"==typeof(r=e)?r:ie)}var ue=U(s,"DataView"),ae=U(s,"Promise"),se=U(s,"Set"),fe=U(s,"WeakMap"),le="[object Map]",pe="[object Promise]",he="[object Set]",ve="[object WeakMap]",ye="[object DataView]",de=L(ue),be=L(X),ge=L(ae),je=L(se),_e=L(fe),me=j;(ue&&me(new ue(new ArrayBuffer(1)))!=ye||X&&me(new X)!=le||ae&&me(ae.resolve())!=pe||se&&me(new se)!=he||fe&&me(new fe)!=ve)&&(me=function(t){var e=j(t),r="[object Object]"==e?t.constructor:void 0,n=r?L(r):"";if(n)switch(n){case de:return ye;case be:return le;case ge:return pe;case je:return he;case _e:return ve}return e});var we=me,Se="[object String]";var xe,Oe=(xe="length",function(t){return null==t?void 0:t[xe]}),ze=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Pe="\\ud800-\\udfff",Ae="["+Pe+"]",Fe="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",ke="\\ud83c[\\udffb-\\udfff]",$e="[^"+Pe+"]",Ee="(?:\\ud83c[\\udde6-\\uddff]){2}",Ce="[\\ud800-\\udbff][\\udc00-\\udfff]",Re="(?:"+Fe+"|"+ke+")"+"?",Le="[\\ufe0e\\ufe0f]?",Te=Le+Re+("(?:\\u200d(?:"+[$e,Ee,Ce].join("|")+")"+Le+Re+")*"),Me="(?:"+[$e+Fe+"?",Fe,Ee,Ce,Ae].join("|")+")",Ne=RegExp(ke+"(?="+ke+")|"+Me+Te,"g");function qe(t){return function(t){return ze.test(t)}(t)?function(t){for(var e=Ne.lastIndex=0;Ne.test(t);)++e;return e}(t):Oe(t)}var De="[object Map]",Be="[object Set]";function Ie(t){if(null==t)return 0;if(ee(t))return"string"==typeof(e=t)||!c(e)&&_(e)&&j(e)==Se?qe(t):t.length;var e,r=we(t);return r==De||r==Be?t.size:te(t).length}function Ue(t){return null==t?[]:function(t,e){return ft(e,(function(e){return t[e]}))}(t,re(t))}function We(t){return"[object Array]"===Object.prototype.toString.call(t)}function Ve(t){return"[object Object]"===Object.prototype.toString.call(t)}function He(t){let e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}var Ze={};!function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}function o(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function i(t,e,n,i,c){if("function"!=typeof n)throw new TypeError("The listener must be a function");var u=new o(n,i||t,c),a=r?r+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],u]:t._events[a].push(u):(t._events[a]=u,t._eventsCount++),t}function c(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function u(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),u.prototype.eventNames=function(){var t,n,o=[];if(0===this._eventsCount)return o;for(n in t=this._events)e.call(t,n)&&o.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},u.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,c=new Array(i);o<i;o++)c[o]=n[o].fn;return c},u.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},u.prototype.emit=function(t,e,n,o,i,c){var u=r?r+t:t;if(!this._events[u])return!1;var a,s,f=this._events[u],l=arguments.length;if(f.fn){switch(f.once&&this.removeListener(t,f.fn,void 0,!0),l){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,e),!0;case 3:return f.fn.call(f.context,e,n),!0;case 4:return f.fn.call(f.context,e,n,o),!0;case 5:return f.fn.call(f.context,e,n,o,i),!0;case 6:return f.fn.call(f.context,e,n,o,i,c),!0}for(s=1,a=new Array(l-1);s<l;s++)a[s-1]=arguments[s];f.fn.apply(f.context,a)}else{var p,h=f.length;for(s=0;s<h;s++)switch(f[s].once&&this.removeListener(t,f[s].fn,void 0,!0),l){case 1:f[s].fn.call(f[s].context);break;case 2:f[s].fn.call(f[s].context,e);break;case 3:f[s].fn.call(f[s].context,e,n);break;case 4:f[s].fn.call(f[s].context,e,n,o);break;default:if(!a)for(p=1,a=new Array(l-1);p<l;p++)a[p-1]=arguments[p];f[s].fn.apply(f[s].context,a)}}return!0},u.prototype.on=function(t,e,r){return i(this,t,e,r,!1)},u.prototype.once=function(t,e,r){return i(this,t,e,r,!0)},u.prototype.removeListener=function(t,e,n,o){var i=r?r+t:t;if(!this._events[i])return this;if(!e)return c(this,i),this;var u=this._events[i];if(u.fn)u.fn!==e||o&&!u.once||n&&u.context!==n||c(this,i);else{for(var a=0,s=[],f=u.length;a<f;a++)(u[a].fn!==e||o&&!u[a].once||n&&u[a].context!==n)&&s.push(u[a]);s.length?this._events[i]=1===s.length?s[0]:s:c(this,i)}return this},u.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&c(this,e)):(this._events=new n,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=r,u.EventEmitter=u,t.exports=u}({get exports(){return Ze},set exports(t){Ze=t}});var Ge=Ze;var Je=/\s/;var Ke=/^\s+/;function Qe(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&Je.test(t.charAt(e)););return e}(t)+1).replace(Ke,""):t}var Xe=NaN,Ye=/^[-+]0x[0-9a-f]+$/i,tr=/^0b[01]+$/i,er=/^0o[0-7]+$/i,rr=parseInt;function nr(t){if("number"==typeof t)return t;if(w(t))return Xe;if(O(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=O(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Qe(t);var r=tr.test(t);return r||er.test(t)?rr(t.slice(2),r?2:8):Ye.test(t)?Xe:+t}var or=1/0,ir=17976931348623157e292;function cr(t){return t?(t=nr(t))===or||t===-or?(t<0?-1:1)*ir:t==t?t:0:0===t?t:0}function ur(t){var e=cr(t),r=e%1;return e==e?r?e-r:e:0}function ar(t){return"[object String]"===Object.prototype.toString.call(t)}function sr(t){return!(!ar(t)||""===t)}function fr(t){return t!=t}function lr(t){let e=!1;if(sr(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(fr(t))return!1;e=!0}return e}function pr(t){if(!lr(t))return 0;return cr(t)}function hr(t){return!!lr(t)&&(t=pr(t),"number"==typeof(e=t)&&e==ur(e));var e}var vr=s.isFinite,yr=Math.min;var dr=function(t){var e=Math[t];return function(t,r){if(t=nr(t),(r=null==r?0:yr(ur(r),292))&&vr(t)){var n=(yt(t)+"e").split("e");return+((n=(yt(e(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}("round"),br=dr;function gr(t){if(!lr(t))return 0;t=pr(t);let e=br(t);return"0"===String(e)?0:e}function jr(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=0,r=[];var n;hr(n=t)&&gr(n)<0&&(t=0),t=gr(t);let o=new Ge;return o.get=function(){if(r.length>0){return e+=1,r.splice(0,1)[0]}return null},o.cb=function(){e-=1,e<0&&(e=0),r.length>0&&o.emit("message",r)},o.push=function(n){r.push(n),(t<=0||e<t)&&o.emit("message",r)},o.clear=function(){e=0,r=[]},o}function _r(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n={},o=!1,i=_t();if(!We(t)&&!Ve(t))return i.reject("rs is not an array or object"),i;let c=!1;if(Ve(t)){c=!0;let e=[];ce(t,((t,r)=>{e.push({k:r,v:t})})),t=e}let u=jr(r);return u.on("message",(function(r){if(o)return;let a,s=u.get();if(He(e)){let t=s.key,r=s.value;if(c&&(t=s.value.k,r=s.value.v),a=e(r,t),!function(t){let e,r=Object.prototype.toString.call(t);if(e="[object Promise]"===r,e)return!0;if("[object Function]"!==r)return!1;try{e="function"!=typeof t.subscribe&&"function"==typeof t.then}catch(t){}return e}(a))throw new Error("return of fun is not a promise")}else a=s.value;a.then((t=>{n[s.key]=t})).catch((t=>{o=!0,u.clear(),i.reject(t)})).finally((()=>{u.cb(),Ie(n)===Ie(t)&&i.resolve(Ue(n))}))})),ce(t,((t,e)=>{u.push({key:e,value:t})})),i}function mr(t){if(!hr(t))return!1;return gr(t)>=0}function wr(t,e){if(!sr(t))return"";if(!mr(e))return"";if(0===(e=gr(e)))return"";let r=t.length-e;return r<0&&(r=0),t.substring(r,r+e)}function Sr(t,e){return sr(t)&&mr(e)?0===(e=gr(e))?"":t.substring(0,e):""}function xr(t,e){return sr(t)&&mr(e)?0===(e=gr(e))?t:Sr(t,t.length-e):""}function Or(t){if(!sr(t))return"";let e=function(t){if(!sr(t))return{path:"",isRoot:!1};for(;t.indexOf("\\\\")>=0;)t=t.replace("\\\\","\\");for(;t.indexOf("//")>=0;)t=t.replace("//","/");if(":"===wr(t,1))return{path:`${t}\\`,isRoot:!0};if("\\"===wr(t,1)){let e=xr(t,1);return":"===wr(e,1)?{path:t,isRoot:!0}:{path:e,isRoot:!1}}if("/"===wr(t,1)){let e=xr(t,1);return 0===e.length?{path:t,isRoot:!0}:{path:e,isRoot:!1}}return{path:t,isRoot:!1}}(t);if(e.isRoot)return e.path;let r=e.path;try{r=r.split("\\").pop().split("/").pop()}catch(t){}return r}function zr(t){return function(t){let e=jt(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"fs");return!!e.existsSync(t)&&!e.lstatSync(t).isDirectory()&&!e.lstatSync(t).isSymbolicLink()}(t,{fs:e})}function Pr(t){let e=jt(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"fs");if(!e.existsSync(t))return!1;let r=e.lstatSync(t);return!r.isFile()&&!r.isSymbolicLink()}function Ar(t){return function(t){let e=jt(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"fs");if(!e.existsSync(t))return{success:"folder does not exist: "+t};if(!Pr(t,{fs:e}))return{error:"input path is not a folder: "+t};try{e.rmSync(t,{recursive:!0,force:!0})}catch(t){return{error:t}}return{success:"done: "+t}}(t,{fs:e})}async function Fr(t){try{zr(t)?e.unlinkSync(t):Pr(t,{fs:e})&&Ar(t),e.writeFileSync(t,"test","utf8"),e.unlinkSync(t)}catch(t){return!1}return!0}r.registerFormat("zip-encrypted",n);var kr={zipFile:async function(n,o){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(n))return Promise.reject("invalid path of source file");if(!e.lstatSync(n).isFile())return Promise.reject("path of source is not file");if(!Fr(o))return Promise.reject("invalid fpSrc");let c=jt(i,"level",9),u=jt(i,"pw","");try{let i=_t();e.existsSync(t.dirname(o))||e.mkdirSync(t.dirname(o),{recursive:!0});let a,s=e.createWriteStream(o);return a=""===u?r("zip",{zlib:{level:c}}):r("zip-encrypted",{zlib:{level:c},encryptionMethod:"zip20",password:u}),s.on("close",(function(){i.resolve("done: "+o)})),a.on("warning",(function(t){})),a.on("error",(function(t){Promise.reject(t)})),a.pipe(s),a.file(n,{name:t.basename(n)}),a.finalize(),i}catch(t){return Promise.reject(t)}},zipFolder:async function(n,o){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(n))return Promise.reject("invalid path of source file");if(!e.lstatSync(n).isDirectory())return Promise.reject("path of source is not folder");if(!Fr(o))return Promise.reject("invalid fpSrc");let c=jt(i,"level",9),u=jt(i,"pw","");try{let i=_t();e.existsSync(t.dirname(o))||e.mkdirSync(t.dirname(o),{recursive:!0});let a,s=e.createWriteStream(o);return a=""===u?r("zip",{zlib:{level:c}}):r("zip-encrypted",{zlib:{level:c},encryptionMethod:"zip20",password:u}),s.on("close",(function(){i.resolve("done: "+o)})),a.on("warning",(function(t){})),a.on("error",(function(t){Promise.reject(t)})),a.pipe(s),a.directory(n,t.basename(n)),a.finalize(),i}catch(t){return Promise.reject(t)}},unzip:async function(r,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(r))return Promise.reject("invalid path of source file");if(!e.lstatSync(r).isFile())return Promise.reject("path of source is not file");if(!Fr(n))return Promise.reject("invalid fpSrc");let c=jt(i,"pw","");try{return await async function(r,n,i){return _r((await o.Open.file(r)).files,(async r=>{let o=t.join(n,r.path);return"File"===r.type?async function(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{e.existsSync(t.dirname(n))||e.mkdirSync(t.dirname(n),{recursive:!0});let i=await r.buffer(o);e.writeFileSync(n,i)}catch(t){return Promise.reject(t)}return"done"}(r,o,i):async function(t){try{e.existsSync(t)||e.mkdirSync(t,{recursive:!0})}catch(t){return Promise.reject(t)}return"done"}(o)}))}(r,n,c),Promise.resolve("done: "+Or(n))}catch(t){return Promise.reject(t)}}};function $r(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(Ve(t)){for(let e in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!ar(t)||""!==t)}(t)||(!!function(t){return!!We(t)&&0===t.length}(t)||!!fr(t)))))}var Er="[object Boolean]";function Cr(t){return!0===(e=t)||!1===e||_(e)&&j(e)==Er;var e}function Rr(t){var e=this.__data__=new Q(t);this.size=e.size}Rr.prototype.clear=function(){this.__data__=new Q,this.size=0},Rr.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},Rr.prototype.get=function(t){return this.__data__.get(t)},Rr.prototype.has=function(t){return this.__data__.has(t)},Rr.prototype.set=function(t,e){var r=this.__data__;if(r instanceof Q){var n=r.__data__;if(!X||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new tt(n)}return r.set(t,e),this.size=r.size,this};function Lr(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new tt;++e<r;)this.add(t[e])}function Tr(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function Mr(t,e){return t.has(e)}Lr.prototype.add=Lr.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Lr.prototype.has=function(t){return this.__data__.has(t)};var Nr=1,qr=2;function Dr(t,e,r,n,o,i){var c=r&Nr,u=t.length,a=e.length;if(u!=a&&!(c&&a>u))return!1;var s=i.get(t),f=i.get(e);if(s&&f)return s==e&&f==t;var l=-1,p=!0,h=r&qr?new Lr:void 0;for(i.set(t,e),i.set(e,t);++l<u;){var v=t[l],y=e[l];if(n)var d=c?n(y,v,l,e,t,i):n(v,y,l,t,e,i);if(void 0!==d){if(d)continue;p=!1;break}if(h){if(!Tr(e,(function(t,e){if(!Mr(h,e)&&(v===t||o(v,t,r,n,i)))return h.push(e)}))){p=!1;break}}else if(v!==y&&!o(v,y,r,n,i)){p=!1;break}}return i.delete(t),i.delete(e),p}var Br=s.Uint8Array;function Ir(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r}function Ur(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}var Wr=1,Vr=2,Hr="[object Boolean]",Zr="[object Date]",Gr="[object Error]",Jr="[object Map]",Kr="[object Number]",Qr="[object RegExp]",Xr="[object Set]",Yr="[object String]",tn="[object Symbol]",en="[object ArrayBuffer]",rn="[object DataView]",nn=f?f.prototype:void 0,on=nn?nn.valueOf:void 0;var cn=Object.prototype.propertyIsEnumerable,un=Object.getOwnPropertySymbols,an=un?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var c=t[r];e(c,r,t)&&(i[o++]=c)}return i}(un(t),(function(e){return cn.call(t,e)})))}:function(){return[]},sn=an;function fn(t){return function(t,e,r){var n=e(t);return c(t)?n:function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}(n,r(t))}(t,re,sn)}var ln=1,pn=Object.prototype.hasOwnProperty;var hn=1,vn="[object Arguments]",yn="[object Array]",dn="[object Object]",bn=Object.prototype.hasOwnProperty;function gn(t,e,r,n,o,i){var u=c(t),a=c(e),s=u?yn:we(t),f=a?yn:we(e),l=(s=s==vn?dn:s)==dn,p=(f=f==vn?dn:f)==dn,h=s==f;if(h&&Rt(t)){if(!Rt(e))return!1;u=!0,l=!1}if(h&&!l)return i||(i=new Rr),u||Zt(t)?Dr(t,e,r,n,o,i):function(t,e,r,n,o,i,c){switch(r){case rn:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case en:return!(t.byteLength!=e.byteLength||!i(new Br(t),new Br(e)));case Hr:case Zr:case Kr:return G(+t,+e);case Gr:return t.name==e.name&&t.message==e.message;case Qr:case Yr:return t==e+"";case Jr:var u=Ir;case Xr:var a=n&Wr;if(u||(u=Ur),t.size!=e.size&&!a)return!1;var s=c.get(t);if(s)return s==e;n|=Vr,c.set(t,e);var f=Dr(u(t),u(e),n,o,i,c);return c.delete(t),f;case tn:if(on)return on.call(t)==on.call(e)}return!1}(t,e,s,r,n,o,i);if(!(r&hn)){var v=l&&bn.call(t,"__wrapped__"),y=p&&bn.call(e,"__wrapped__");if(v||y){var d=v?t.value():t,b=y?e.value():e;return i||(i=new Rr),o(d,b,r,n,i)}}return!!h&&(i||(i=new Rr),function(t,e,r,n,o,i){var c=r&ln,u=fn(t),a=u.length;if(a!=fn(e).length&&!c)return!1;for(var s=a;s--;){var f=u[s];if(!(c?f in e:pn.call(e,f)))return!1}var l=i.get(t),p=i.get(e);if(l&&p)return l==e&&p==t;var h=!0;i.set(t,e),i.set(e,t);for(var v=c;++s<a;){var y=t[f=u[s]],d=e[f];if(n)var b=c?n(d,y,f,e,t,i):n(y,d,f,t,e,i);if(!(void 0===b?y===d||o(y,d,r,n,i):b)){h=!1;break}v||(v="constructor"==f)}if(h&&!v){var g=t.constructor,j=e.constructor;g==j||!("constructor"in t)||!("constructor"in e)||"function"==typeof g&&g instanceof g&&"function"==typeof j&&j instanceof j||(h=!1)}return i.delete(t),i.delete(e),h}(t,e,r,n,o,i))}function jn(t,e,r,n,o){return t===e||(null==t||null==e||!_(t)&&!_(e)?t!=t&&e!=e:gn(t,e,r,n,jn,o))}function _n(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if((!We(n=e)||0===n.length||1===n.length&&$r(n[0]))&&!sr(e))throw new Error("args is not an effective array or string");var n;sr(e)&&(e=[e]);let o=jt(r,"mode");"spawn"!==o&&"exec"!==o&&"execFile"!==o&&(o="spawn");let c=jt(r,"cbStdout"),u=jt(r,"cbStderr"),a=jt(r,"codeCmd");sr(a)||(a="utf8");let s=jt(r,"useChcp");Cr(s)||(s=!1);let f=_t();if(!function(t,e){function r(t){return We(t)?t:[t]}if($r(t))return!1;if(0===(t=r(t)).length)return!1;if($r(t))return!1;if(0===(e=r(e)).length)return!1;for(let r=0;r<t.length;r++)for(let i=0;i<e.length;i++)if(n=t[r],o=e[i],jn(n,o))return!0;var n,o;return!1}(o,["spawn","exec","execFile"]))return f.reject(`invalid mode[${o}]`),f;let l=null,p="";try{if("spawn"===o){let r=Sr(t,1),n=wr(t,1);if('"'===r||'"'===n||"'"===r||"'"===n)throw new Error("prog of spawn doens not need to add quotes");l=i.spawn(t,e,{windowsHide:!0,shell:!1})}else if("exec"===o){let r="";s&&(r="cmd /c chcp 65001>nul &&"),l=i.exec(`${r} ${t} ${e.join(" ")} & exit`,{windowsHide:!0,encoding:a})}else"execFile"===o&&(l=i.execFile(t,e,{windowsHide:!0,encoding:a}))}catch(t){return f.reject(t),f}return l.stdout.on("data",(t=>{let e="";e="spawn"===o?t.toString(a):t.toString(),p+=e+"\n",He(c)&&c(e)})),l.stderr.on("data",(t=>{let e="";e="spawn"===o?t.toString(a):t.toString(),p+=e+"\n",He(u)&&u(e)})),l.on("close",(t=>{0!==t?f.reject(`code[${t}]:\n${p}`):f.resolve(p)})),l.on("error",(t=>{f.reject(t)})),f}var mn=function(){let t="C:\\Program Files\\7-Zip\\7z.exe";async function r(e,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=["a",r,e,`-mx${arguments.length>2&&void 0!==arguments[2]?arguments[2]:9}`];return""!==n&&o.push(`-p${n}`),await _n(t,o)}return{setProg:function(r){return e.existsSync(r)?e.lstatSync(r).isFile()?{error:"path of 7z is not file"}:(t=r,{success:"done: "+r}):{error:"invalid path of 7z"}},zipFile:async function(t,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(t))return Promise.reject("invalid path of source file");if(!e.lstatSync(t).isFile())return Promise.reject("path of source is not file");if(!Fr(n))return Promise.reject("invalid fpSrc");let i=jt(o,"level",9),c=jt(o,"pw",""),u=null,a=await r(t,n,i,c).catch((t=>{u=t}));return u?Promise.reject(u):{state:"finish: "+n,msg7z:a}},zipFolder:async function(t,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(t))return Promise.reject("invalid path of source file");if(!e.lstatSync(t).isDirectory())return Promise.reject("path of source is not folder");if(!Fr(n))return Promise.reject("invalid fpSrc");let i=jt(o,"level",9),c=jt(o,"pw",""),u=null,a=await r(t,n,i,c).catch((t=>{u=t}));return u?Promise.reject(u):{state:"finish: "+n,msg7z:a}},unzip:async function(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.existsSync(r))return Promise.reject("invalid path of source file");if(!e.lstatSync(r).isFile())return Promise.reject("path of source is not file");if(!Fr(n))return Promise.reject("invalid fpSrc");let i=jt(o,"pw",""),c=["x",r,"-o"+n];""!==i&&c.push(`-p${i}`);let u=null,a=await _n(t,c).catch((t=>{u=t.toString()}));return u?Promise.reject(u):{state:"finish: "+Or(n),msg7z:a}}}}();return{mZip:kr,m7z:mn}}));
//# sourceMappingURL=w-zip.umd.js.map
