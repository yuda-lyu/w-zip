/*!
 * w-zip v1.0.20
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("path"),require("fs"),require("archiver"),require("archiver-zip-encrypted"),require("unzipper"),require("child_process")):"function"==typeof define&&define.amd?define(["path","fs","archiver","archiver-zip-encrypted","unzipper","child_process"],t):(e="undefined"!=typeof globalThis?globalThis:e||self)["w-zip"]=t(e.path,e.fs,e.archiver,e["archiver-zip-encrypted"],e.unzipper,e.child_process)}(this,(function(e,t,r,n,o,i){"use strict";var c=Array.isArray,u="object"==typeof global&&global&&global.Object===Object&&global,s="object"==typeof self&&self&&self.Object===Object&&self,a=u||s||Function("return this")(),f=a.Symbol,l=Object.prototype,p=l.hasOwnProperty,h=l.toString,v=f?f.toStringTag:void 0;var y=Object.prototype.toString;var d="[object Null]",b="[object Undefined]",j=f?f.toStringTag:void 0;function g(e){return null==e?void 0===e?b:d:j&&j in Object(e)?function(e){var t=p.call(e,v),r=e[v];try{e[v]=void 0;var n=!0}catch(e){}var o=h.call(e);return n&&(t?e[v]=r:delete e[v]),o}(e):function(e){return y.call(e)}(e)}function m(e){return null!=e&&"object"==typeof e}var _="[object Symbol]";function S(e){return"symbol"==typeof e||m(e)&&g(e)==_}var w=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,x=/^\w*$/;function O(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var P="[object AsyncFunction]",z="[object Function]",F="[object GeneratorFunction]",A="[object Proxy]";function k(e){if(!O(e))return!1;var t=g(e);return t==z||t==F||t==P||t==A}var $,E=a["__core-js_shared__"],C=($=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+$:"";var R=Function.prototype.toString;function T(e){if(null!=e){try{return R.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var M=/^\[object .+?Constructor\]$/,N=Function.prototype,q=Object.prototype,L=N.toString,D=q.hasOwnProperty,I=RegExp("^"+L.call(D).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function B(e){return!(!O(e)||(t=e,C&&C in t))&&(k(e)?I:M).test(T(e));var t}function U(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return B(r)?r:void 0}var W=U(Object,"create");var V=Object.prototype.hasOwnProperty;var Z=Object.prototype.hasOwnProperty;function G(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function H(e,t){for(var r,n,o=e.length;o--;)if((r=e[o][0])===(n=t)||r!=r&&n!=n)return o;return-1}G.prototype.clear=function(){this.__data__=W?W(null):{},this.size=0},G.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},G.prototype.get=function(e){var t=this.__data__;if(W){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return V.call(t,e)?t[e]:void 0},G.prototype.has=function(e){var t=this.__data__;return W?void 0!==t[e]:Z.call(t,e)},G.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=W&&void 0===t?"__lodash_hash_undefined__":t,this};var J=Array.prototype.splice;function K(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}K.prototype.clear=function(){this.__data__=[],this.size=0},K.prototype.delete=function(e){var t=this.__data__,r=H(t,e);return!(r<0)&&(r==t.length-1?t.pop():J.call(t,r,1),--this.size,!0)},K.prototype.get=function(e){var t=this.__data__,r=H(t,e);return r<0?void 0:t[r][1]},K.prototype.has=function(e){return H(this.__data__,e)>-1},K.prototype.set=function(e,t){var r=this.__data__,n=H(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};var Q=U(a,"Map");function X(e,t){var r,n,o=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof t?"string":"hash"]:o.map}function Y(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Y.prototype.clear=function(){this.size=0,this.__data__={hash:new G,map:new(Q||K),string:new G}},Y.prototype.delete=function(e){var t=X(this,e).delete(e);return this.size-=t?1:0,t},Y.prototype.get=function(e){return X(this,e).get(e)},Y.prototype.has=function(e){return X(this,e).has(e)},Y.prototype.set=function(e,t){var r=X(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};var ee="Expected a function";function te(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(ee);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var c=e.apply(this,n);return r.cache=i.set(o,c)||i,c};return r.cache=new(te.Cache||Y),r}te.Cache=Y;var re,ne,oe,ie=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ce=/\\(\\)?/g,ue=(re=function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ie,(function(e,r,n,o){t.push(n?o.replace(ce,"$1"):r||e)})),t},ne=te(re,(function(e){return 500===oe.size&&oe.clear(),e})),oe=ne.cache,ne),se=ue;function ae(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}var fe=1/0,le=f?f.prototype:void 0,pe=le?le.toString:void 0;function he(e){if("string"==typeof e)return e;if(c(e))return ae(e,he)+"";if(S(e))return pe?pe.call(e):"";var t=e+"";return"0"==t&&1/e==-fe?"-0":t}function ve(e){return null==e?"":he(e)}function ye(e,t){return c(e)?e:function(e,t){if(c(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!S(e))||x.test(e)||!w.test(e)||null!=t&&e in Object(t)}(e,t)?[e]:se(ve(e))}var de=1/0;function be(e){if("string"==typeof e||S(e))return e;var t=e+"";return"0"==t&&1/e==-de?"-0":t}function je(e,t,r){var n=null==e?void 0:function(e,t){for(var r=0,n=(t=ye(t,e)).length;null!=e&&r<n;)e=e[be(t[r++])];return r&&r==n?e:void 0}(e,t);return void 0===n?r:n}function ge(){let e,t,r=new Promise((function(){e=arguments[0],t=arguments[1]}));return r.resolve=e,r.reject=t,r}function me(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}var _e,Se=function(e,t,r){for(var n=-1,o=Object(e),i=r(e),c=i.length;c--;){var u=i[_e?c:++n];if(!1===t(o[u],u,o))break}return e},we=Se;function xe(e){return m(e)&&"[object Arguments]"==g(e)}var Oe=Object.prototype,Pe=Oe.hasOwnProperty,ze=Oe.propertyIsEnumerable,Fe=xe(function(){return arguments}())?xe:function(e){return m(e)&&Pe.call(e,"callee")&&!ze.call(e,"callee")},Ae=Fe;var ke="object"==typeof exports&&exports&&!exports.nodeType&&exports,$e=ke&&"object"==typeof module&&module&&!module.nodeType&&module,Ee=$e&&$e.exports===ke?a.Buffer:void 0,Ce=(Ee?Ee.isBuffer:void 0)||function(){return!1},Re=9007199254740991,Te=/^(?:0|[1-9]\d*)$/;function Me(e,t){var r=typeof e;return!!(t=null==t?Re:t)&&("number"==r||"symbol"!=r&&Te.test(e))&&e>-1&&e%1==0&&e<t}var Ne=9007199254740991;function qe(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Ne}var Le={};Le["[object Float32Array]"]=Le["[object Float64Array]"]=Le["[object Int8Array]"]=Le["[object Int16Array]"]=Le["[object Int32Array]"]=Le["[object Uint8Array]"]=Le["[object Uint8ClampedArray]"]=Le["[object Uint16Array]"]=Le["[object Uint32Array]"]=!0,Le["[object Arguments]"]=Le["[object Array]"]=Le["[object ArrayBuffer]"]=Le["[object Boolean]"]=Le["[object DataView]"]=Le["[object Date]"]=Le["[object Error]"]=Le["[object Function]"]=Le["[object Map]"]=Le["[object Number]"]=Le["[object Object]"]=Le["[object RegExp]"]=Le["[object Set]"]=Le["[object String]"]=Le["[object WeakMap]"]=!1;var De="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ie=De&&"object"==typeof module&&module&&!module.nodeType&&module,Be=Ie&&Ie.exports===De&&u.process,Ue=function(){try{var e=Ie&&Ie.require&&Ie.require("util").types;return e||Be&&Be.binding&&Be.binding("util")}catch(e){}}(),We=Ue&&Ue.isTypedArray,Ve=We?function(e){return function(t){return e(t)}}(We):function(e){return m(e)&&qe(e.length)&&!!Le[g(e)]},Ze=Ve,Ge=Object.prototype.hasOwnProperty;function He(e,t){var r=c(e),n=!r&&Ae(e),o=!r&&!n&&Ce(e),i=!r&&!n&&!o&&Ze(e),u=r||n||o||i,s=u?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],a=s.length;for(var f in e)!t&&!Ge.call(e,f)||u&&("length"==f||o&&("offset"==f||"parent"==f)||i&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||Me(f,a))||s.push(f);return s}var Je=Object.prototype;var Ke=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),Qe=Ke,Xe=Object.prototype.hasOwnProperty;function Ye(e){if(r=(t=e)&&t.constructor,t!==("function"==typeof r&&r.prototype||Je))return Qe(e);var t,r,n=[];for(var o in Object(e))Xe.call(e,o)&&"constructor"!=o&&n.push(o);return n}function et(e){return null!=e&&qe(e.length)&&!k(e)}function tt(e){return et(e)?He(e):Ye(e)}var rt=function(e,t){return function(r,n){if(null==r)return r;if(!et(r))return e(r,n);for(var o=r.length,i=t?o:-1,c=Object(r);(t?i--:++i<o)&&!1!==n(c[i],i,c););return r}}((function(e,t){return e&&we(e,t,tt)})),nt=rt;function ot(e){return e}function it(e,t){var r;return(c(e)?me:nt)(e,"function"==typeof(r=t)?r:ot)}var ct=U(a,"DataView"),ut=U(a,"Promise"),st=U(a,"Set"),at=U(a,"WeakMap"),ft="[object Map]",lt="[object Promise]",pt="[object Set]",ht="[object WeakMap]",vt="[object DataView]",yt=T(ct),dt=T(Q),bt=T(ut),jt=T(st),gt=T(at),mt=g;(ct&&mt(new ct(new ArrayBuffer(1)))!=vt||Q&&mt(new Q)!=ft||ut&&mt(ut.resolve())!=lt||st&&mt(new st)!=pt||at&&mt(new at)!=ht)&&(mt=function(e){var t=g(e),r="[object Object]"==t?e.constructor:void 0,n=r?T(r):"";if(n)switch(n){case yt:return vt;case dt:return ft;case bt:return lt;case jt:return pt;case gt:return ht}return t});var _t=mt,St="[object String]";var wt,xt=(wt="length",function(e){return null==e?void 0:e[wt]}),Ot=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Pt="\\ud800-\\udfff",zt="["+Pt+"]",Ft="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",At="\\ud83c[\\udffb-\\udfff]",kt="[^"+Pt+"]",$t="(?:\\ud83c[\\udde6-\\uddff]){2}",Et="[\\ud800-\\udbff][\\udc00-\\udfff]",Ct="(?:"+Ft+"|"+At+")"+"?",Rt="[\\ufe0e\\ufe0f]?",Tt=Rt+Ct+("(?:\\u200d(?:"+[kt,$t,Et].join("|")+")"+Rt+Ct+")*"),Mt="(?:"+[kt+Ft+"?",Ft,$t,Et,zt].join("|")+")",Nt=RegExp(At+"(?="+At+")|"+Mt+Tt,"g");function qt(e){return function(e){return Ot.test(e)}(e)?function(e){for(var t=Nt.lastIndex=0;Nt.test(e);)++t;return t}(e):xt(e)}var Lt="[object Map]",Dt="[object Set]";function It(e){if(null==e)return 0;if(et(e))return"string"==typeof(t=e)||!c(t)&&m(t)&&g(t)==St?qt(e):e.length;var t,r=_t(e);return r==Lt||r==Dt?e.size:Ye(e).length}function Bt(e){return null==e?[]:function(e,t){return ae(t,(function(t){return e[t]}))}(e,tt(e))}function Ut(e){return"[object Array]"===Object.prototype.toString.call(e)}function Wt(e){return"[object Object]"===Object.prototype.toString.call(e)}function Vt(e){let t=Object.prototype.toString.call(e);return"[object Function]"===t||"[object AsyncFunction]"===t}var Zt={};!function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function o(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function i(e,t,n,i,c){if("function"!=typeof n)throw new TypeError("The listener must be a function");var u=new o(n,i||e,c),s=r?r+t:t;return e._events[s]?e._events[s].fn?e._events[s]=[e._events[s],u]:e._events[s].push(u):(e._events[s]=u,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function u(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),u.prototype.eventNames=function(){var e,n,o=[];if(0===this._eventsCount)return o;for(n in e=this._events)t.call(e,n)&&o.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},u.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,c=new Array(i);o<i;o++)c[o]=n[o].fn;return c},u.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},u.prototype.emit=function(e,t,n,o,i,c){var u=r?r+e:e;if(!this._events[u])return!1;var s,a,f=this._events[u],l=arguments.length;if(f.fn){switch(f.once&&this.removeListener(e,f.fn,void 0,!0),l){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,t),!0;case 3:return f.fn.call(f.context,t,n),!0;case 4:return f.fn.call(f.context,t,n,o),!0;case 5:return f.fn.call(f.context,t,n,o,i),!0;case 6:return f.fn.call(f.context,t,n,o,i,c),!0}for(a=1,s=new Array(l-1);a<l;a++)s[a-1]=arguments[a];f.fn.apply(f.context,s)}else{var p,h=f.length;for(a=0;a<h;a++)switch(f[a].once&&this.removeListener(e,f[a].fn,void 0,!0),l){case 1:f[a].fn.call(f[a].context);break;case 2:f[a].fn.call(f[a].context,t);break;case 3:f[a].fn.call(f[a].context,t,n);break;case 4:f[a].fn.call(f[a].context,t,n,o);break;default:if(!s)for(p=1,s=new Array(l-1);p<l;p++)s[p-1]=arguments[p];f[a].fn.apply(f[a].context,s)}}return!0},u.prototype.on=function(e,t,r){return i(this,e,t,r,!1)},u.prototype.once=function(e,t,r){return i(this,e,t,r,!0)},u.prototype.removeListener=function(e,t,n,o){var i=r?r+e:e;if(!this._events[i])return this;if(!t)return c(this,i),this;var u=this._events[i];if(u.fn)u.fn!==t||o&&!u.once||n&&u.context!==n||c(this,i);else{for(var s=0,a=[],f=u.length;s<f;s++)(u[s].fn!==t||o&&!u[s].once||n&&u[s].context!==n)&&a.push(u[s]);a.length?this._events[i]=1===a.length?a[0]:a:c(this,i)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&c(this,t)):(this._events=new n,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=r,u.EventEmitter=u,e.exports=u}({get exports(){return Zt},set exports(e){Zt=e}});var Gt=Zt;var Ht=/\s/;var Jt=/^\s+/;function Kt(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&Ht.test(e.charAt(t)););return t}(e)+1).replace(Jt,""):e}var Qt=NaN,Xt=/^[-+]0x[0-9a-f]+$/i,Yt=/^0b[01]+$/i,er=/^0o[0-7]+$/i,tr=parseInt;function rr(e){if("number"==typeof e)return e;if(S(e))return Qt;if(O(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=O(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Kt(e);var r=Yt.test(e);return r||er.test(e)?tr(e.slice(2),r?2:8):Xt.test(e)?Qt:+e}var nr=1/0,or=17976931348623157e292;function ir(e){return e?(e=rr(e))===nr||e===-nr?(e<0?-1:1)*or:e==e?e:0:0===e?e:0}function cr(e){var t=ir(e),r=t%1;return t==t?r?t-r:t:0}function ur(e){return"[object String]"===Object.prototype.toString.call(e)}function sr(e){return!(!ur(e)||""===e)}function ar(e){return e!=e}function fr(e){let t=!1;if(sr(e))t=!isNaN(Number(e));else if(function(e){return"[object Number]"===Object.prototype.toString.call(e)}(e)){if(ar(e))return!1;t=!0}return t}function lr(e){if(!fr(e))return 0;return ir(e)}function pr(e){return!!fr(e)&&(e=lr(e),"number"==typeof(t=e)&&t==cr(t));var t}var hr=a.isFinite,vr=Math.min;var yr=function(e){var t=Math[e];return function(e,r){if(e=rr(e),(r=null==r?0:vr(cr(r),292))&&hr(e)){var n=(ve(e)+"e").split("e");return+((n=(ve(t(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return t(e)}}("round"),dr=yr;function br(e){if(!fr(e))return 0;e=lr(e);let t=dr(e);return"0"===String(t)?0:t}function jr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=0,r=[];var n;pr(n=e)&&br(n)<0&&(e=0),e=br(e);let o=new Gt;return o.get=function(){if(r.length>0){return t+=1,r.splice(0,1)[0]}return null},o.cb=function(){t-=1,t<0&&(t=0),r.length>0&&o.emit("message",r)},o.push=function(n){r.push(n),(e<=0||t<e)&&o.emit("message",r)},o.clear=function(){t=0,r=[]},o}function gr(e){if(!pr(e))return!1;return br(e)>=0}function mr(e,t){if(!sr(e))return"";if(!gr(t))return"";if(0===(t=br(t)))return"";let r=e.length-t;return r<0&&(r=0),e.substring(r,r+t)}function _r(e,t){return sr(e)&&gr(t)?0===(t=br(t))?"":e.substring(0,t):""}function Sr(e,t){return sr(e)&&gr(t)?0===(t=br(t))?e:_r(e,e.length-t):""}function wr(e){if(!sr(e))return"";let t=function(e){if(!sr(e))return{path:"",isRoot:!1};for(;e.indexOf("\\\\")>=0;)e=e.replace("\\\\","\\");for(;e.indexOf("//")>=0;)e=e.replace("//","/");if(":"===mr(e,1))return{path:`${e}\\`,isRoot:!0};if("\\"===mr(e,1)){let t=Sr(e,1);return":"===mr(t,1)?{path:e,isRoot:!0}:{path:t,isRoot:!1}}if("/"===mr(e,1)){let t=Sr(e,1);return 0===t.length?{path:e,isRoot:!0}:{path:t,isRoot:!1}}return{path:e,isRoot:!1}}(e);if(t.isRoot)return t.path;let r=t.path;try{r=r.split("\\").pop().split("/").pop()}catch(e){}return r}function xr(e){return function(e){let t=je(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"fs");return!!t.existsSync(e)&&!t.lstatSync(e).isDirectory()&&!t.lstatSync(e).isSymbolicLink()}(e,{fs:t})}function Or(e){let t=je(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"fs");if(!t.existsSync(e))return!1;let r=t.lstatSync(e);return!r.isFile()&&!r.isSymbolicLink()}function Pr(e){return function(e){let t=je(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"fs");if(!t.existsSync(e))return{success:"folder does not exist: "+e};if(!Or(e,{fs:t}))return{error:"input path is not a folder: "+e};try{t.rmSync(e,{recursive:!0,force:!0})}catch(e){return{error:e}}return{success:"done: "+e}}(e,{fs:t})}async function zr(e){try{xr(e)?t.unlinkSync(e):Or(e,{fs:t})&&Pr(e),t.writeFileSync(e,"test","utf8"),t.unlinkSync(e)}catch(e){return!1}return!0}r.registerFormat("zip-encrypted",n);var Fr={zipFile:async function(n,o){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t.existsSync(n))return Promise.reject("invalid path of source file");if(!t.lstatSync(n).isFile())return Promise.reject("path of source is not file");if(!zr(o))return Promise.reject("invalid fpSrc");let c=je(i,"level",9),u=je(i,"pw","");try{let i=ge();t.existsSync(e.dirname(o))||t.mkdirSync(e.dirname(o),{recursive:!0});let s,a=t.createWriteStream(o);return s=""===u?r("zip",{zlib:{level:c}}):r("zip-encrypted",{zlib:{level:c},encryptionMethod:"zip20",password:u}),a.on("close",(function(){i.resolve("done: "+o)})),s.on("warning",(function(e){})),s.on("error",(function(e){Promise.reject(e)})),s.pipe(a),s.file(n,{name:e.basename(n)}),s.finalize(),i}catch(e){return Promise.reject(e)}},zipFolder:async function(n,o){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t.existsSync(n))return Promise.reject("invalid path of source file");if(!t.lstatSync(n).isDirectory())return Promise.reject("path of source is not folder");if(!zr(o))return Promise.reject("invalid fpSrc");let c=je(i,"level",9),u=je(i,"pw","");try{let i=ge();t.existsSync(e.dirname(o))||t.mkdirSync(e.dirname(o),{recursive:!0});let s,a=t.createWriteStream(o);return s=""===u?r("zip",{zlib:{level:c}}):r("zip-encrypted",{zlib:{level:c},encryptionMethod:"zip20",password:u}),a.on("close",(function(){i.resolve("done: "+o)})),s.on("warning",(function(e){})),s.on("error",(function(e){Promise.reject(e)})),s.pipe(a),s.directory(n,e.basename(n)),s.finalize(),i}catch(e){return Promise.reject(e)}},unzip:async function(r,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t.existsSync(r))return Promise.reject("invalid path of source file");if(!t.lstatSync(r).isFile())return Promise.reject("path of source is not file");if(!zr(n))return Promise.reject("invalid fpSrc");let c=je(i,"pw","");try{return await async function(r,n,i){return function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n={},o=!1,i=ge();if(!Ut(e)&&!Wt(e))return i.reject("rs is not an array or object"),i;let c=!1;if(Wt(e)){c=!0;let t=[];it(e,((e,r)=>{t.push({k:r,v:e})})),e=t}let u=jr(r);return u.on("message",(function(r){if(o)return;let s,a=u.get();if(Vt(t)){let e=a.key,r=a.value;c&&(e=a.value.k,r=a.value.v),s=t(r,e)}else s=a.value;s.then((e=>{n[a.key]=e})).catch((e=>{o=!0,u.clear(),i.reject(e)})).finally((()=>{u.cb(),It(n)===It(e)&&i.resolve(Bt(n))}))})),it(e,((e,t)=>{u.push({key:t,value:e})})),i}((await o.Open.file(r)).files,(async r=>{let o=e.join(n,r.path);return"File"===r.type?async function(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{t.existsSync(e.dirname(n))||t.mkdirSync(e.dirname(n),{recursive:!0});let i=await r.buffer(o);t.writeFileSync(n,i)}catch(e){return Promise.reject(e)}return"done"}(r,o,i):async function(e){try{t.existsSync(e)||t.mkdirSync(e,{recursive:!0})}catch(e){return Promise.reject(e)}return"done"}(o)}))}(r,n,c),Promise.resolve("done: "+wr(n))}catch(e){return Promise.reject(e)}}};function Ar(e){return!!function(e){return"[object Undefined]"===Object.prototype.toString.call(e)}(e)||(!!function(e){return"[object Null]"===Object.prototype.toString.call(e)}(e)||(!!function(e){if(Wt(e)){for(let t in e)return!1;return!0}return!1}(e)||(!!function(e){return!(!ur(e)||""!==e)}(e)||(!!function(e){return!!Ut(e)&&0===e.length}(e)||!!ar(e)))))}var kr="[object Boolean]";function $r(e){return!0===(t=e)||!1===t||m(t)&&g(t)==kr;var t}function Er(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if((!Ut(n=t)||0===n.length||1===n.length&&Ar(n[0]))&&!sr(t))throw new Error("args is not an effective array or string");var n;sr(t)&&(t=[t]);let o=je(r,"mode");"spawn"!==o&&"exec"!==o&&"execFile"!==o&&(o="spawn");let c=je(r,"cbStdout"),u=je(r,"cbStderr"),s=je(r,"codeCmd");sr(s)||(s="utf8");let a=je(r,"useChcp");$r(a)||(a=!1);let f=ge(),l="",p="",h=null;if("spawn"===o){let r=_r(e,1),n=mr(e,1);if('"'===r||'"'===n||"'"===r||"'"===n)throw new Error("prog of spawn doens not need to add quotes");h=i.spawn(e,t,{encoding:s,shell:!1})}else if("exec"===o){let r="";a&&(r="cmd /c chcp 65001>nul &&"),h=i.exec(`${r} ${e} ${t.join(" ")} & exit`,{encoding:s})}else{if("execFile"!==o)throw new Error(`invalid mode[${o}]`);h=i.execFile(e,t,{encoding:s})}return h.stdout.on("data",(e=>{let t=e.toString().trim();l+=t+"\n",Vt(c)&&c(t)})),h.stderr.on("data",(e=>{let t=e.toString().trim();p+=t+"\n",Vt(u)&&u(t)})),h.on("close",(e=>{sr(p)?f.reject(p):f.resolve(l)})),h.on("error",(e=>{f.reject(e)})),f}var Cr=function(){let e="C:\\Program Files\\7-Zip\\7z.exe";async function r(t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=["a",r,t,`-mx${arguments.length>2&&void 0!==arguments[2]?arguments[2]:9}`];return""!==n&&o.push(`-p${n}`),await Er(e,o)}return{setProg:function(r){return t.existsSync(r)?t.lstatSync(r).isFile()?{error:"path of 7z is not file"}:(e=r,{success:"done: "+r}):{error:"invalid path of 7z"}},zipFile:async function(e,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t.existsSync(e))return Promise.reject("invalid path of source file");if(!t.lstatSync(e).isFile())return Promise.reject("path of source is not file");if(!zr(n))return Promise.reject("invalid fpSrc");let i=je(o,"level",9),c=je(o,"pw",""),u=null,s=await r(e,n,i,c).catch((e=>{u=e}));return u?Promise.reject(u):{state:"finish: "+n,msg7z:s}},zipFolder:async function(e,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t.existsSync(e))return Promise.reject("invalid path of source file");if(!t.lstatSync(e).isDirectory())return Promise.reject("path of source is not folder");if(!zr(n))return Promise.reject("invalid fpSrc");let i=je(o,"level",9),c=je(o,"pw",""),u=null,s=await r(e,n,i,c).catch((e=>{u=e}));return u?Promise.reject(u):{state:"finish: "+n,msg7z:s}},unzip:async function(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t.existsSync(r))return Promise.reject("invalid path of source file");if(!t.lstatSync(r).isFile())return Promise.reject("path of source is not file");if(!zr(n))return Promise.reject("invalid fpSrc");let i=je(o,"pw",""),c=["x",r,"-o"+n];""!==i&&c.push(`-p${i}`);let u=null,s=await Er(e,c).catch((e=>{u=e}));return u?Promise.reject(u):{state:"finish: "+wr(n),msg7z:s}}}}();return{mZip:Fr,m7z:Cr}}));
//# sourceMappingURL=w-zip.umd.js.map
